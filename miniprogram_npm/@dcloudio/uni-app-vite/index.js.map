{"version":3,"sources":["index.js","vue/index.js","plugins/template.js","utils.js","plugins/manifestJson.js","plugins/stats.js","plugins/easycom.js","vue/plugins/confusion.js","vue/plugins/mainJs.js","vue/plugins/pagesJson.js","nvue/plugins/esbuild.js","nvue/utils.js","nvue/plugins/appCss.js","vue/plugins/renderjs.js","vue/plugin/index.js","plugin/configResolved.js","nvue/index.js","nvue/plugin/index.js","nvue/plugin/transforms/transformVideo.js","nvue/plugin/transforms/transformText.js","nvue/plugin/transforms/transformRootNode.js","nvue/plugin/transforms/vModel.js","nvue/plugin/transforms/vShow.js","nvue/plugin/transforms/errors.js","nvue/plugin/transforms/transformAttrs.js","nvue/plugins/pagesJson.js","nvue/plugins/mainJs.js","nvue/plugins/renderjs.js","plugin/index.js","plugin/uni/index.js","plugin/build.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ACHA,AFMA;ADIA,AENA,ACHA,AFMA;ADIA,AENA,ACHA,AFMA;ADIA,AIZA,AFMA,ACHA,AFMA;ADIA,AIZA,AFMA,ACHA,AFMA;ADIA,AIZA,AFMA,ACHA,AFMA;ADIA,AIZA,ACHA,AHSA,ACHA,AFMA;ADIA,AIZA,ACHA,AHSA,ACHA,AFMA;AGRA,ACHA,AHSA,ACHA,AFMA;AKdA,AFMA,ACHA,AHSA,ACHA,AFMA;AKdA,AFMA,ACHA,AHSA,ACHA,AFMA;AKdA,AFMA,ACHA,AHSA,ACHA,AFMA;AKdA,AFMA,ACHA,AHSA,ACHA,AFMA,AMlBA;ADIA,AFMA,ACHA,AHSA,ADGA,AMlBA;ADIA,AFMA,ACHA,AHSA,ADGA,AMlBA;ADIA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA;AFOA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA;AFOA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA;AFOA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AHUA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AHUA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,AJYA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,AJYA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,AJYA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;ACFA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AGRA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AGRA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AGRA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA;AGRA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AMlBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AavCA,APqBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AavCA,APqBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,ALeA,AFMA,ACHA,AHSA,ADGA,AavCA,APqBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AJYA,AavCA,APqBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AJYA,AavCA,APqBA,ACHA,ACHA,AIZA;ADIA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AJYA,AavCA,APqBA,ACHA,ACHA,AIZA;AGRA,AJYA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AJYA,AavCA,APqBA,ACHA,ACHA,AIZA;AGRA,AJYA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AJYA,AavCA,APqBA,ACHA,ACHA,AIZA;AGRA,AJYA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,ACHA,ACHA,AIZA;AGRA,ACHA,ALeA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,ACHA,ACHA,AIZA;AGRA,ACHA,ALeA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,ACHA,ACHA,AIZA;AGRA,ACHA,ALeA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,ACHA,ACHA,AIZA;AGRA,ACHA,ACHA,ANkBA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,ACHA,ACHA,AIZA;AGRA,ACHA,ACHA,ANkBA,AFMA,ACHA,AIZA,AT2BA,AFMA,ACHA,AS3BA,APqBA,AENA,AIZA;AGRA,ACHA,ACHA,ANkBA,AFMA,ACHA,AIZA,AT2BA,ADGA,AS3BA,APqBA,AENA,AIZA;AGRA,ACHA,AENA,ADGA,ANkBA,AFMA,ACHA,AIZA,AT2BA,ADGA,AS3BA,APqBA,AENA,AIZA;AGRA,ACHA,AENA,ADGA,ANkBA,AFMA,ACHA,AIZA,AT2BA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AENA,ADGA,ANkBA,AFMA,ACHA,AIZA,AT2BA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,ANkBA,AFMA,ACHA,ALeA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,ANkBA,AFMA,AJYA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,ANkBA,AFMA,AJYA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,AT2BA,AFMA,AJYA,AQxBA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,AT2BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,AT2BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AGTA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,AHSA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,AHSA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,AHSA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,AIZA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,Ae7CA,AXiCA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,Ae7CA,AXiCA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,ACHA,AV8BA,AFMA,Ae7CA,AXiCA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AXiCA,APqBA,AENA,AIZA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AXiCA,APqBA,AMlBA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AXiCA,APqBA,AMlBA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AbuCA,APqBA,AMlBA;AGRA,ACHA,AMlBA,ACHA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AbuCA,APqBA,AMlBA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AbuCA,APqBA,AMlBA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,Ad0CA,APqBA,AMlBA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,Ad0CA,APqBA,AMlBA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,Ad0CA,APqBA,AMlBA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,ACHA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,ADGA,AGTA,AT2BA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AENA,AGTA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ADGA,APqBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AOrBA,AJYA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,AFMA,ACHA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,AgBhDA,ADGA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,AGTA,ARwBA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,ADGA,Af6CA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AhBgDA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AhBgDA,ADGA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AjBmDA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AjBmDA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AjBmDA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AjBmDA;AIXA,ALeA,AFMA,Ae7CA,AKfA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA,AjBmDA;AIXA,ALeA,AFMA,AoB5DA;AbwCA,ALeA,AFMA,AoB5DA;AbwCA,ALeA,AFMA,AoB5DA;AbwCA,ALeA,AFMA,AoB5DA;AbwCA,ALeA,AFMA;AOpBA,ALeA,AFMA;AOpBA,ALeA,AFMA;AOpBA,ALeA,AFMA;AOpBA,ALeA,AFMA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA,APqBA;AOpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst vue_1 = require(\"./vue\");\nconst nvue_1 = require(\"./nvue\");\nconst plugin_1 = require(\"./plugin\");\nexports.default = () => {\n    return [\n        (0, plugin_1.uniAppPlugin)({\n            renderer: process.env.UNI_RENDERER,\n            appService: process.env.UNI_RENDERER_NATIVE === 'appService',\n        }),\n        ...(process.env.UNI_COMPILER === 'nvue'\n            ? (0, nvue_1.initNVuePlugins)()\n            : (0, vue_1.initVuePlugins)()),\n    ];\n};\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initVuePlugins = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst template_1 = require(\"../plugins/template\");\nconst manifestJson_1 = require(\"../plugins/manifestJson\");\nconst stats_1 = require(\"../plugins/stats\");\nconst easycom_1 = require(\"../plugins/easycom\");\nconst confusion_1 = require(\"./plugins/confusion\");\nconst mainJs_1 = require(\"./plugins/mainJs\");\nconst pagesJson_1 = require(\"./plugins/pagesJson\");\nconst renderjs_1 = require(\"./plugins/renderjs\");\nconst plugin_1 = require(\"./plugin\");\nfunction initUniCssScopedPluginFilter(inputDir) {\n    const styleIsolation = (0, uni_cli_shared_1.getAppStyleIsolation)((0, uni_cli_shared_1.parseManifestJsonOnce)(inputDir));\n    if (styleIsolation === 'shared') {\n        return;\n    }\n    if (styleIsolation === 'isolated') {\n        // isolated: 对所有非 App.vue 增加 scoped\n        return (id) => (0, uni_cli_shared_1.isVueSfcFile)(id) && !id.endsWith('App.vue');\n    }\n    // apply-shared: 仅对非页面组件增加 scoped\n    return (id) => (0, uni_cli_shared_1.isVueSfcFile)(id) && !id.endsWith('App.vue') && !(0, uni_cli_shared_1.isUniPageFile)(id, inputDir);\n}\nfunction initVuePlugins() {\n    const plugins = [\n        (0, easycom_1.uniEasycomPlugin)({ exclude: uni_cli_shared_1.UNI_EASYCOM_EXCLUDE }),\n        (0, uni_cli_shared_1.uniHBuilderXConsolePlugin)(),\n        (0, mainJs_1.uniMainJsPlugin)(),\n        (0, manifestJson_1.uniManifestJsonPlugin)(),\n        (0, pagesJson_1.uniPagesJsonPlugin)(),\n        (0, uni_cli_shared_1.uniViteInjectPlugin)('uni:app-inject', (0, uni_cli_shared_1.initAppProvide)()),\n        (0, renderjs_1.uniRenderjsPlugin)(),\n        (0, template_1.uniTemplatePlugin)(),\n        (0, stats_1.uniStatsPlugin)(),\n        (0, plugin_1.uniAppVuePlugin)(),\n        (0, confusion_1.uniConfusionPlugin)(),\n    ];\n    const filter = initUniCssScopedPluginFilter(process.env.UNI_INPUT_DIR);\n    if (filter) {\n        plugins.unshift((0, uni_cli_shared_1.uniCssScopedPlugin)({ filter }));\n    }\n    return plugins;\n}\nexports.initVuePlugins = initVuePlugins;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniTemplatePlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst utils_1 = require(\"../utils\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniTemplatePlugin({ renderer, } = {}) {\n    let outputDir;\n    return {\n        name: 'uni:app-template',\n        enforce: 'post',\n        configResolved() {\n            outputDir = process.env.UNI_OUTPUT_DIR;\n            if (renderer !== 'native') {\n                fs_extra_1.default.copySync((0, uni_cli_shared_1.resolveBuiltIn)('@dcloudio/uni-app-plus/dist/uni-app-view.umd.js'), path_1.default.resolve(outputDir, 'uni-app-view.umd.js'), {\n                    overwrite: true,\n                });\n            }\n            fs_extra_1.default.copySync(utils_1.templateDir, outputDir, {\n                overwrite: true,\n                filter(src) {\n                    if (renderer === 'native') {\n                        if (src.includes('__uniappquill') ||\n                            src.includes('__uniappautomator')) {\n                            return false;\n                        }\n                    }\n                    return !src.includes('__uniappview.html');\n                },\n            });\n        },\n    };\n}\nexports.uniTemplatePlugin = uniTemplatePlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.nvueOutDir = exports.templateDir = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nexports.templateDir = path_1.default.resolve(__dirname, '../lib/template/');\nfunction nvueOutDir() {\n    return path_1.default.join(process.env.UNI_OUTPUT_DIR, '../.nvue');\n}\nexports.nvueOutDir = nvueOutDir;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniManifestJsonPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniManifestJsonPlugin() {\n    return (0, uni_cli_shared_1.defineUniManifestJsonPlugin)((opts) => {\n        const inputDir = process.env.UNI_INPUT_DIR;\n        return {\n            name: 'uni:app-manifest-json',\n            enforce: 'pre',\n            transform(code, id) {\n                if (!opts.filter(id)) {\n                    return;\n                }\n                this.addWatchFile(path_1.default.resolve(inputDir, 'manifest.json'));\n                (0, uni_cli_shared_1.getLocaleFiles)(path_1.default.resolve(inputDir, 'locale')).forEach((filepath) => {\n                    this.addWatchFile(filepath);\n                });\n                const manifestJson = (0, uni_cli_shared_1.normalizeAppManifestJson)((0, uni_cli_shared_1.parseJson)(code), (0, uni_cli_shared_1.parsePagesJsonOnce)(inputDir, process.env.UNI_PLATFORM));\n                // 生成一个空的 app-config.js，兼容基座已有规范\n                this.emitFile({\n                    fileName: uni_cli_shared_1.APP_CONFIG,\n                    type: 'asset',\n                    source: '(function(){})();',\n                });\n                this.emitFile({\n                    fileName: `manifest.json`,\n                    type: 'asset',\n                    source: JSON.stringify(manifestJson, null, 2),\n                });\n                return {\n                    code: '',\n                    map: null,\n                };\n            },\n        };\n    });\n}\nexports.uniManifestJsonPlugin = uniManifestJsonPlugin;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniStatsPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst emittedHashMap = new WeakMap();\nfunction uniStatsPlugin() {\n    let resolvedConfig;\n    return {\n        name: 'uni:app-stats',\n        enforce: 'post',\n        configResolved(config) {\n            resolvedConfig = config;\n            emittedHashMap.set(resolvedConfig, new Map());\n        },\n        writeBundle(_, bundle) {\n            if (resolvedConfig.isProduction) {\n                // 仅dev生效\n                return;\n            }\n            const emittedHash = emittedHashMap.get(resolvedConfig);\n            const changedFiles = [];\n            Object.keys(bundle).forEach((filename) => {\n                const outputFile = bundle[filename];\n                let outputFileHash = '';\n                if (outputFile.type === 'asset') {\n                    outputFileHash = (0, uni_cli_shared_1.hash)(outputFile.source);\n                }\n                else {\n                    outputFileHash = (0, uni_cli_shared_1.hash)(outputFile.code);\n                }\n                if (emittedHash.get(filename) !== outputFileHash) {\n                    emittedHash.set(filename, outputFileHash);\n                    changedFiles.push(filename);\n                }\n            });\n            process.env.UNI_APP_CHANGED_FILES = changedFiles.length\n                ? JSON.stringify(changedFiles)\n                : '';\n        },\n    };\n}\nexports.uniStatsPlugin = uniStatsPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniEasycomPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst pluginutils_1 = require(\"@rollup/pluginutils\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniEasycomPlugin(options) {\n    const filter = (0, pluginutils_1.createFilter)(options.include, options.exclude);\n    return {\n        name: 'uni:app-easycom',\n        transform(code, id) {\n            if (!filter(id)) {\n                return;\n            }\n            const { filename, query } = (0, uni_cli_shared_1.parseVueRequest)(id);\n            if (query.type !== 'template' &&\n                (query.vue || !uni_cli_shared_1.EXTNAME_VUE_TEMPLATE.includes(path_1.default.extname(filename)))) {\n                return;\n            }\n            let i = 0;\n            const importDeclarations = [];\n            code = code.replace(/_resolveComponent\\(\"(.+?)\"(, true)?\\)/g, (str, name) => {\n                if (name && !name.startsWith('_')) {\n                    const source = (0, uni_cli_shared_1.matchEasycom)(name);\n                    if (source) {\n                        // 处理easycom组件优先级\n                        return (0, uni_cli_shared_1.genResolveEasycomCode)(importDeclarations, str, (0, uni_cli_shared_1.addImportDeclaration)(importDeclarations, `__easycom_${i++}`, source));\n                    }\n                }\n                return str;\n            });\n            if (importDeclarations.length) {\n                code = importDeclarations.join('') + code;\n            }\n            return {\n                code,\n                map: null,\n            };\n        },\n    };\n}\nexports.uniEasycomPlugin = uniEasycomPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniConfusionPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniConfusionPlugin() {\n    const inputDir = process.env.UNI_INPUT_DIR;\n    const hasConfusion = process.env.NODE_ENV === 'production' && (0, uni_cli_shared_1.hasConfusionFile)(inputDir);\n    return {\n        name: 'uni:app-vue-confusion',\n        enforce: 'post',\n        apply: 'build',\n        config() {\n            if (!hasConfusion) {\n                return;\n            }\n            return {\n                build: {\n                    rollupOptions: {\n                        output: {\n                            format: process.env.UNI_APP_CODE_SPLITING ? 'amd' : 'cjs',\n                            manualChunks(id) {\n                                if ((0, uni_cli_shared_1.isConfusionFile)(path_1.default.relative(inputDir, id))) {\n                                    return (0, uni_cli_shared_1.removeExt)(uni_cli_shared_1.APP_CONFUSION_FILENAME);\n                                }\n                            },\n                        },\n                    },\n                },\n            };\n        },\n        generateBundle(_, bundle) {\n            if (!hasConfusion) {\n                return;\n            }\n            const appConfusionChunk = bundle[uni_cli_shared_1.APP_CONFUSION_FILENAME];\n            if (!appConfusionChunk) {\n                return;\n            }\n            appConfusionChunk.code = wrapperAppConfusionCode(appConfusionChunk.code);\n            const appServiceChunk = bundle[uni_cli_shared_1.APP_SERVICE_FILENAME];\n            if (!appServiceChunk) {\n                return;\n            }\n            appServiceChunk.code = wrapperAppServiceCode(appServiceChunk.code);\n        },\n    };\n}\nexports.uniConfusionPlugin = uniConfusionPlugin;\nfunction replaceRequireVueCode(code) {\n    return code.replace(/require\\(['\"]vue['\"]\\)/gi, `$cjs_require$('vue')`);\n}\nfunction replaceRequireAppConfusionCode(code) {\n    return code.replace(new RegExp(`require\\\\(['\"].\\\\/${uni_cli_shared_1.APP_CONFUSION_FILENAME}['\"]\\\\)`, 'gi'), `$cjs_require$('./${uni_cli_shared_1.APP_CONFUSION_FILENAME}')`);\n}\nfunction wrapperAppServiceCode(code) {\n    return replaceRequireAppConfusionCode(replaceRequireVueCode(code));\n}\nfunction wrapperAppConfusionCode(code) {\n    return `function $cjs_require$(name){if(name==='vue'){return Vue;}if(name==='./${uni_cli_shared_1.APP_CONFUSION_FILENAME}'){return $appConfusion$;}};const $appConfusion$ = {};(function(exports){${replaceRequireVueCode(code)}})($appConfusion$);\n`;\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniMainJsPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniMainJsPlugin() {\n    return (0, uni_cli_shared_1.defineUniMainJsPlugin)((opts) => {\n        return {\n            name: 'uni:app-vue-main-js',\n            enforce: 'pre',\n            transform(code, id) {\n                if (opts.filter(id)) {\n                    code = code.includes('createSSRApp')\n                        ? createApp(code)\n                        : createLegacyApp(code);\n                    return {\n                        code: `import './${uni_cli_shared_1.PAGES_JSON_JS}';` + code,\n                        map: { mappings: '' },\n                    };\n                }\n            },\n        };\n    });\n}\nexports.uniMainJsPlugin = uniMainJsPlugin;\nfunction createApp(code) {\n    return `${code.replace('createSSRApp', 'createVueApp as createSSRApp')};const {app:__app__,Vuex:__Vuex__,Pinia:__Pinia__}=createApp();uni.Vuex=__Vuex__;uni.Pinia=__Pinia__;__app__.provide('__globalStyles', __uniConfig.styles);__app__._component.mpType='app';__app__._component.render=()=>{};__app__.mount(\"#app\");`;\n}\nfunction createLegacyApp(code) {\n    return `function createApp(rootComponent,rootProps){rootComponent.mpTye='app';rootComponent.render=()=>{};const app=createVueApp(rootComponent,rootProps);app.provide('__globalStyles', __uniConfig.styles);const oldMount=app.mount;app.mount=(container)=>{const appVm=oldMount.call(app,container);return appVm;};return app;};${code.replace('createApp', 'createVueApp')}`;\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniPagesJsonPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst esbuild_1 = require(\"../../nvue/plugins/esbuild\");\nfunction uniPagesJsonPlugin() {\n    return (0, uni_cli_shared_1.defineUniPagesJsonPlugin)((opts) => {\n        return {\n            name: 'uni:app-vue-pages-json',\n            enforce: 'pre',\n            transform(code, id) {\n                if (!opts.filter(id)) {\n                    return;\n                }\n                this.addWatchFile(path_1.default.resolve(process.env.UNI_INPUT_DIR, 'pages.json'));\n                (0, uni_cli_shared_1.getLocaleFiles)(path_1.default.resolve(process.env.UNI_INPUT_DIR, 'locale')).forEach((filepath) => {\n                    this.addWatchFile(filepath);\n                });\n                const pagesJson = (0, uni_cli_shared_1.normalizePagesJson)(code, process.env.UNI_PLATFORM);\n                pagesJson.pages.forEach((page) => {\n                    if (!page.style.isNVue) {\n                        this.addWatchFile(path_1.default.resolve(process.env.UNI_INPUT_DIR, page.path + '.vue'));\n                    }\n                });\n                this.emitFile({\n                    fileName: uni_cli_shared_1.APP_CONFIG_SERVICE,\n                    type: 'asset',\n                    source: (0, uni_cli_shared_1.normalizeAppConfigService)(pagesJson, (0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR)),\n                });\n                return {\n                    code: `import './${uni_cli_shared_1.MANIFEST_JSON_JS}'\\n` +\n                        (0, uni_cli_shared_1.normalizeAppPagesJson)(pagesJson),\n                    map: { mappings: '' },\n                };\n            },\n            generateBundle(_, bundle) {\n                const outputFile = bundle[uni_cli_shared_1.APP_CONFIG_SERVICE];\n                if (outputFile && outputFile.type === 'asset') {\n                    // 补充 nvue styles\n                    ;\n                    outputFile.source = (0, esbuild_1.wrapperNVueAppStyles)(outputFile.source);\n                }\n            },\n        };\n    });\n}\nexports.uniPagesJsonPlugin = uniPagesJsonPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.wrapperNVueAppStyles = exports.uniEsbuildPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../../utils\");\nconst utils_2 = require(\"../utils\");\nconst appCss_1 = require(\"./appCss\");\nconst debugEsbuild = (0, debug_1.default)('uni:app-nvue-esbuild');\nconst emittedHashMap = new WeakMap();\nfunction uniEsbuildPlugin({ appService, }) {\n    let resolvedConfig;\n    let buildOptions;\n    const nvueOutputDir = (0, utils_1.nvueOutDir)();\n    const outputDir = process.env.UNI_OUTPUT_DIR;\n    let isFirst = true;\n    return {\n        name: 'uni:app-nvue-esbuild',\n        enforce: 'post',\n        configResolved(config) {\n            buildOptions = {\n                format: 'iife',\n                target: 'es6',\n                minify: config.build.minify ? true : false,\n                banner: {\n                    js: `\"use weex:vue\";\n${uni_cli_shared_1.polyfillCode}`,\n                },\n                bundle: true,\n                write: false,\n                plugins: [esbuildGlobalPlugin((0, utils_2.esbuildGlobals)(appService))],\n            };\n            resolvedConfig = config;\n            emittedHashMap.set(resolvedConfig, new Map());\n        },\n        async writeBundle(_, bundle) {\n            const entryPoints = [];\n            const assets = [];\n            Object.keys(bundle).forEach((name) => {\n                const chunk = bundle[name];\n                if (chunk.type === 'chunk' &&\n                    chunk.facadeModuleId &&\n                    chunk.facadeModuleId.endsWith('.nvue')) {\n                    entryPoints.push(name);\n                }\n                else if (chunk.type === 'asset') {\n                    assets.push(name);\n                }\n            });\n            // 仅 nvueOutputDir 时 copy\n            if (!appService) {\n                assets.forEach((name) => {\n                    fs_extra_1.default.copySync(path_1.default.resolve(nvueOutputDir, name), path_1.default.resolve(outputDir, name), { overwrite: false });\n                });\n            }\n            if (!entryPoints.length) {\n                return;\n            }\n            const emittedHash = emittedHashMap.get(resolvedConfig);\n            const changedFiles = [];\n            if (buildAppCss()) {\n                changedFiles.push(uni_cli_shared_1.APP_CONFIG_SERVICE);\n            }\n            debugEsbuild('start', entryPoints.length, entryPoints);\n            for (const filename of entryPoints) {\n                await buildNVuePage(filename, buildOptions).then((code) => {\n                    const outputFileHash = (0, uni_cli_shared_1.hash)(code);\n                    if (emittedHash.get(filename) !== outputFileHash) {\n                        changedFiles.push(filename);\n                        emittedHash.set(filename, outputFileHash);\n                        return fs_extra_1.default.outputFile(path_1.default.resolve(outputDir, filename), code);\n                    }\n                });\n            }\n            if (!isFirst && changedFiles.length) {\n                process.env[changedFiles.includes(uni_cli_shared_1.APP_CONFIG_SERVICE)\n                    ? 'UNI_APP_CHANGED_FILES'\n                    : 'UNI_APP_CHANGED_PAGES'] = JSON.stringify(changedFiles);\n            }\n            debugEsbuild('end');\n            isFirst = false;\n        },\n    };\n}\nexports.uniEsbuildPlugin = uniEsbuildPlugin;\n/**\n * 将 nvue 全局 css 样式注入 app-config-service.js\n * @returns\n */\nfunction buildAppCss() {\n    const appCssJsFilename = path_1.default.join((0, utils_1.nvueOutDir)(), appCss_1.APP_CSS_JS);\n    if (!fs_extra_1.default.existsSync(appCssJsFilename)) {\n        return;\n    }\n    const appCssJsCode = fs_extra_1.default.readFileSync(appCssJsFilename, 'utf8');\n    const appCssJsFn = new Function('exports', appCssJsCode);\n    const exports = { styles: [] };\n    appCssJsFn(exports);\n    const appCssJsonCode = JSON.stringify(exports.styles);\n    if (process.env.UNI_NVUE_APP_STYLES === appCssJsonCode) {\n        return;\n    }\n    process.env.UNI_NVUE_APP_STYLES = appCssJsonCode;\n    // 首次 build 时，可能还没生成 app-config-service 的文件，故仅写入环境变量\n    const appConfigServiceFilename = path_1.default.join(process.env.UNI_OUTPUT_DIR, uni_cli_shared_1.APP_CONFIG_SERVICE);\n    if (!fs_extra_1.default.existsSync(appConfigServiceFilename)) {\n        return;\n    }\n    const appConfigServiceCode = fs_extra_1.default.readFileSync(appConfigServiceFilename, 'utf8');\n    fs_extra_1.default.writeFileSync(appConfigServiceFilename, wrapperNVueAppStyles(appConfigServiceCode));\n    return true;\n}\nfunction buildNVuePage(filename, options) {\n    return (0, uni_cli_shared_1.transformWithEsbuild)(`import App from './${filename}'\nconst webview = plus.webview.currentWebview()\nif(webview){\n  const __pageId = parseInt(webview.id)\n  const __pagePath = '${(0, uni_cli_shared_1.removeExt)(filename)}'\n  let __pageQuery = {}\n  try{ __pageQuery = JSON.parse(webview.__query__) }catch(e){}\n  App.mpType = 'page'\n  const app = Vue.createPageApp(App,{$store:getApp({allowDefault:true}).$store,__pageId,__pagePath,__pageQuery})\n  app.provide('__globalStyles', Vue.useCssStyles([...__uniConfig.styles, ...(App.styles||[])]))\n  app.mount('#root')\n}`, path_1.default.join((0, utils_1.nvueOutDir)(), 'main.js'), options).then((res) => {\n        if (res.outputFiles) {\n            return res.outputFiles[0].text;\n        }\n        return '';\n    });\n}\nfunction esbuildGlobalPlugin(options) {\n    const keys = Object.keys(options);\n    return {\n        name: 'global',\n        setup(build) {\n            keys.forEach((key) => {\n                const namespace = key + '-ns';\n                build.onResolve({ filter: new RegExp('^' + key + '$') }, ({ path }) => {\n                    return {\n                        path,\n                        namespace,\n                    };\n                });\n                build.onLoad({ filter: /.*/, namespace }, () => ({\n                    contents: `module.exports = ${options[key]}`,\n                    loader: 'js',\n                }));\n            });\n        },\n    };\n}\nfunction wrapperNVueAppStyles(code) {\n    return code.replace(/__uniConfig.styles=(.*);\\/\\/styles/, `__uniConfig.styles=${process.env.UNI_NVUE_APP_STYLES || '[]'};//styles`);\n}\nexports.wrapperNVueAppStyles = wrapperNVueAppStyles;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.esbuildGlobals = exports.globals = exports.external = void 0;\nfunction external(appService) {\n    return appService ? ['vue'] : ['vue', 'vuex', 'pinia'];\n}\nexports.external = external;\nfunction globals(appService) {\n    return appService\n        ? { vue: 'Vue' }\n        : {\n            vue: 'Vue',\n            vuex: 'Vuex',\n            pinia: 'Pinia',\n        };\n}\nexports.globals = globals;\nfunction esbuildGlobals(appService) {\n    return appService\n        ? { vue: 'Vue' }\n        : {\n            vue: 'Vue',\n            vuex: 'uni.Vuex',\n            pinia: 'uni.Pinia',\n        };\n}\nexports.esbuildGlobals = esbuildGlobals;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createRollupError = exports.uniAppCssPlugin = exports.APP_CSS_JS = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst compiler_sfc_1 = require(\"@vue/compiler-sfc\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nexports.APP_CSS_JS = './app.css.js';\nfunction uniAppCssPlugin() {\n    const inputDir = process.env.UNI_INPUT_DIR;\n    const appVueFilename = (0, uni_cli_shared_1.normalizePath)(path_1.default.resolve(inputDir, 'App.vue'));\n    return {\n        name: 'uni:app-nvue-app-style',\n        // 提前到 @vite/plugin-vue 之前执行，因为在 nvue 编译时，仅 import 了 App.vue 的 styles，这样导致 descriptor\n        // 一直使用的是上一次的（plugin-vue 会在 transformMain 中生成新的 descriptor），故不再交由 plugin-vue 来 load\n        // 而是当前插件直接处理\n        enforce: 'pre',\n        resolveId(id) {\n            if (id === exports.APP_CSS_JS) {\n                return exports.APP_CSS_JS;\n            }\n        },\n        load(id) {\n            if (id === exports.APP_CSS_JS) {\n                return genAppStylesCode(appVueFilename, this);\n            }\n            const { filename, query } = (0, uni_cli_shared_1.parseVueRequest)(id);\n            if (query.vue && query.type === 'style' && appVueFilename === filename) {\n                const descriptor = createAppDescriptor(filename, this);\n                const block = descriptor.styles[query.index];\n                if (block) {\n                    return {\n                        code: block.content,\n                        map: '',\n                    };\n                }\n            }\n        },\n    };\n}\nexports.uniAppCssPlugin = uniAppCssPlugin;\nconst defaultAppStylesCode = `exports.styles = []`;\nasync function genAppStylesCode(filename, pluginContext) {\n    pluginContext.addWatchFile(filename);\n    const descriptor = createAppDescriptor(filename, pluginContext);\n    if (!descriptor.styles.length) {\n        return defaultAppStylesCode;\n    }\n    let stylesCode = ``;\n    const styleVars = [];\n    for (let i = 0; i < descriptor.styles.length; i++) {\n        const style = descriptor.styles[i];\n        const src = style.src || descriptor.filename;\n        const attrsQuery = attrsToQuery(style.attrs, 'css');\n        const srcQuery = style.src ? `&src=${descriptor.id}` : ``;\n        const query = `?vue&type=style&index=${i}${srcQuery}&inline`;\n        const styleRequest = src + query + attrsQuery;\n        stylesCode += `\\nimport _style_${i} from ${JSON.stringify(styleRequest)}`;\n        styleVars.push(`_style_${i}`);\n    }\n    return `\n${stylesCode}\nexports.styles = [${styleVars.join(',')}]\n`;\n}\nfunction readAppCode(filename) {\n    if (!fs_extra_1.default.existsSync(filename)) {\n        return ``;\n    }\n    const source = fs_extra_1.default.readFileSync(filename, 'utf8');\n    if (source.includes('#endif')) {\n        return (0, uni_cli_shared_1.preNVueJs)((0, uni_cli_shared_1.preNVueHtml)(source));\n    }\n    return source;\n}\nlet appDescriptor;\nfunction createAppDescriptor(filename, pluginContext) {\n    const source = readAppCode(filename);\n    const id = (0, uni_cli_shared_1.hash)(source);\n    if (!appDescriptor || appDescriptor.id !== id) {\n        const { descriptor, errors } = (0, compiler_sfc_1.parse)(source, {\n            filename,\n        });\n        descriptor.id = id;\n        if (errors.length) {\n            errors.forEach((error) => pluginContext.error(createRollupError(filename, error)));\n        }\n        appDescriptor = descriptor;\n    }\n    return appDescriptor;\n}\nfunction createRollupError(id, error) {\n    const { message, name, stack } = error;\n    const rollupError = {\n        id,\n        plugin: 'vue',\n        message,\n        name,\n        stack,\n    };\n    if ('code' in error && error.loc) {\n        rollupError.loc = {\n            file: id,\n            line: error.loc.start.line,\n            column: error.loc.start.column,\n        };\n    }\n    return rollupError;\n}\nexports.createRollupError = createRollupError;\n// these are built-in query parameters so should be ignored\n// if the user happen to add them as attrs\nconst ignoreList = ['id', 'index', 'src', 'type', 'lang', 'module'];\nfunction attrsToQuery(attrs, langFallback, forceLangFallback = false) {\n    let query = ``;\n    for (const name in attrs) {\n        const value = attrs[name];\n        if (!ignoreList.includes(name)) {\n            query += `&${encodeURIComponent(name)}${value ? `=${encodeURIComponent(value)}` : ``}`;\n        }\n    }\n    if (langFallback || attrs.lang) {\n        query +=\n            `lang` in attrs\n                ? forceLangFallback\n                    ? `&lang.${langFallback}`\n                    : `&lang.${attrs.lang}`\n                : `&lang.${langFallback}`;\n    }\n    return query;\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniRenderjsPlugin = exports.APP_RENDERJS_JS = exports.APP_WXS_JS = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst debugRenderjs = (0, debug_1.default)('uni:app-renderjs');\nexports.APP_WXS_JS = 'app-wxs.js';\nexports.APP_RENDERJS_JS = 'app-renderjs.js';\nconst wxsModulesCache = new WeakMap();\nconst renderjsModulesCache = new WeakMap();\nfunction uniRenderjsPlugin() {\n    let resolvedConfig;\n    let changed = false;\n    return {\n        name: 'uni:app-vue-renderjs',\n        configResolved(config) {\n            resolvedConfig = config;\n            wxsModulesCache.set(resolvedConfig, new Map());\n            renderjsModulesCache.set(resolvedConfig, new Map());\n        },\n        async transform(code, id) {\n            const { type, name, filename } = (0, uni_cli_shared_1.parseRenderjs)(id);\n            if (!type) {\n                return;\n            }\n            if (type !== 'wxs' && type !== 'renderjs') {\n                return;\n            }\n            debugRenderjs(id);\n            this.addWatchFile((0, uni_cli_shared_1.cleanUrl)(id));\n            if (!name) {\n                this.error((0, uni_cli_shared_1.missingModuleName)(type, code));\n            }\n            const modulePath = (0, uni_cli_shared_1.normalizePath)(path_1.default.normalize(path_1.default.relative(process.env.UNI_INPUT_DIR, id)));\n            const moduleHashId = (0, uni_cli_shared_1.hash)(modulePath);\n            const globalName = type === 'wxs' ? uni_shared_1.WXS_MODULES : uni_shared_1.RENDERJS_MODULES;\n            const { isProduction } = resolvedConfig;\n            const resultCode = normalizeCode(type === 'wxs'\n                ? await transformWxs(code, filename, `__${globalName}['${moduleHashId}']`, isProduction)\n                : await transformRenderjs(code, filename, `__${globalName}['${moduleHashId}']`, isProduction), globalName, isProduction);\n            if (type === 'wxs') {\n                wxsModulesCache.get(resolvedConfig).set(moduleHashId, resultCode);\n            }\n            else {\n                renderjsModulesCache.get(resolvedConfig).set(moduleHashId, resultCode);\n            }\n            changed = true;\n            debugRenderjs(type, modulePath, moduleHashId);\n            return {\n                code: `export default Comp => {\n          ;(Comp.$${type} || (Comp.$${type} = [])).push('${name}')\n          ;(Comp.$${globalName} || (Comp.$${globalName} = {}))['${name}'] = '${moduleHashId}'\n        }`,\n                map: { mappings: '' },\n            };\n        },\n        generateBundle() {\n            if (!changed) {\n                return;\n            }\n            const wxsCode = [...wxsModulesCache.get(resolvedConfig).values()].join('\\n');\n            if (wxsCode) {\n                this.emitFile({\n                    fileName: exports.APP_WXS_JS,\n                    source: `var __${uni_shared_1.WXS_MODULES}={};\\n` + wxsCode,\n                    type: 'asset',\n                });\n            }\n            const renderjsCode = [\n                ...renderjsModulesCache.get(resolvedConfig).values(),\n            ].join('\\n');\n            if (renderjsCode) {\n                this.emitFile({\n                    fileName: exports.APP_RENDERJS_JS,\n                    source: `var __${uni_shared_1.RENDERJS_MODULES}={};\\n` + renderjsCode,\n                    type: 'asset',\n                });\n            }\n        },\n    };\n}\nexports.uniRenderjsPlugin = uniRenderjsPlugin;\nfunction normalizeCode(code, globalName, isProduction) {\n    return code.replace(isProduction\n        ? `var __${globalName}=__${globalName}||{};`\n        : `var __${globalName} = __${globalName} || {};`, '');\n}\nfunction transformWxs(code, filename, globalName, isProduction) {\n    return (0, uni_cli_shared_1.transformWithEsbuild)(code, filename, {\n        format: 'iife',\n        globalName,\n        target: 'es6',\n        minify: isProduction ? true : false,\n        bundle: true,\n        write: false,\n    }).then((res) => {\n        if (res.outputFiles) {\n            return res.outputFiles[0].text;\n        }\n        return '';\n    });\n}\nfunction transformRenderjs(code, filename, globalName, isProduction) {\n    return (0, uni_cli_shared_1.transformWithEsbuild)(code, filename, {\n        format: 'iife',\n        globalName,\n        target: 'es6',\n        minify: isProduction ? true : false,\n        bundle: true,\n        write: false,\n    }).then((res) => {\n        if (res.outputFiles) {\n            return res.outputFiles[0].text;\n        }\n        return '';\n    });\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniAppVuePlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst renderjs_1 = require(\"../plugins/renderjs\");\nconst configResolved_1 = require(\"../../plugin/configResolved\");\nconst utils_1 = require(\"../../utils\");\nconst code_1 = require(\"@dcloudio/uni-cli-shared/dist/json/app/pages/code\");\nfunction uniAppVuePlugin() {\n    const inputDir = process.env.UNI_INPUT_DIR;\n    const mainPath = (0, uni_cli_shared_1.resolveMainPathOnce)(inputDir);\n    let appCss = '';\n    function normalizeCssChunkFilename(id) {\n        return (0, uni_cli_shared_1.removeExt)((0, uni_cli_shared_1.normalizePath)(path_1.default.relative(inputDir, id))) + '.css';\n    }\n    return {\n        name: 'uni:app-vue',\n        config() {\n            return {\n                css: {\n                    postcss: {\n                        plugins: (0, uni_cli_shared_1.initPostcssPlugin)({\n                            uniApp: (0, uni_cli_shared_1.parseRpx2UnitOnce)(inputDir, process.env.UNI_PLATFORM),\n                        }),\n                    },\n                },\n                build: {\n                    rollupOptions: {\n                        external: ['vue', '@vue/shared'],\n                        output: {\n                            name: 'AppService',\n                            banner: uni_cli_shared_1.polyfillCode + code_1.restoreGlobalCode,\n                            format: process.env.UNI_APP_CODE_SPLITING ? 'amd' : 'iife',\n                            amd: {\n                                autoId: true,\n                            },\n                            entryFileNames: uni_cli_shared_1.APP_SERVICE_FILENAME,\n                            globals: {\n                                vue: 'Vue',\n                                '@vue/shared': 'uni.VueShared',\n                            },\n                        },\n                    },\n                },\n            };\n        },\n        configResolved: (0, configResolved_1.createConfigResolved)({\n            createCssPostPlugin(config) {\n                return (0, uni_cli_shared_1.cssPostPlugin)(config, {\n                    chunkCssFilename(id) {\n                        if (id === mainPath) {\n                            return 'app.css';\n                        }\n                        else if ((0, uni_cli_shared_1.isUniPageSfcFile)(id, inputDir)) {\n                            return normalizeCssChunkFilename(id);\n                        }\n                    },\n                    chunkCssCode(filename, cssCode) {\n                        if (filename === 'app.css') {\n                            if (!appCss) {\n                                appCss = fs_extra_1.default.readFileSync((0, uni_cli_shared_1.resolveBuiltIn)('@dcloudio/uni-app-plus/dist/style.css'), 'utf8');\n                            }\n                            return appCss + '\\n' + cssCode;\n                        }\n                        return cssCode;\n                    },\n                });\n            },\n        }),\n        generateBundle(_, bundle) {\n            this.emitFile({\n                fileName: '__uniappview.html',\n                source: genViewHtml(bundle),\n                type: 'asset',\n            });\n        },\n    };\n}\nexports.uniAppVuePlugin = uniAppVuePlugin;\nfunction genViewHtml(bundle) {\n    const viewHtmlStr = fs_extra_1.default.readFileSync(path_1.default.join(utils_1.templateDir, '__uniappview.html'), 'utf8');\n    const { globalStyle } = (0, uni_cli_shared_1.parsePagesJsonOnce)(process.env.UNI_INPUT_DIR, process.env.UNI_PLATFORM);\n    const __uniConfig = {\n        globalStyle: {\n            rpxCalcMaxDeviceWidth: globalStyle.rpxCalcMaxDeviceWidth,\n            rpxCalcBaseDeviceWidth: globalStyle.rpxCalcBaseDeviceWidth,\n        },\n    };\n    const wxsCode = bundle[renderjs_1.APP_WXS_JS]\n        ? `<script src=\"${renderjs_1.APP_WXS_JS}\"></script>`\n        : '';\n    const renderjsCode = bundle[renderjs_1.APP_RENDERJS_JS]\n        ? `<script src=\"${renderjs_1.APP_RENDERJS_JS}\"></script>`\n        : '';\n    const automatorCode = process.env.UNI_AUTOMATOR_WS_ENDPOINT\n        ? `<script src=\"__uniappautomator.js\"></script>`\n        : '';\n    return viewHtmlStr\n        .toString()\n        .replace('<!--wxsCode-->', wxsCode)\n        .replace('<!--renderjsCode-->', renderjsCode)\n        .replace('<!--automatorCode-->', automatorCode)\n        .replace('/*__uniConfig*/', `var __uniConfig = ${JSON.stringify(__uniConfig)}`);\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createConfigResolved = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction createConfigResolved({ createCssPostPlugin, }) {\n    return (config) => {\n        (0, uni_cli_shared_1.injectCssPlugin)(config);\n        (0, uni_cli_shared_1.injectCssPostPlugin)(config, createCssPostPlugin(config));\n        // 强制不inline\n        config.build.assetsInlineLimit = 0;\n        (0, uni_cli_shared_1.injectAssetPlugin)(config);\n    };\n}\nexports.createConfigResolved = createConfigResolved;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initNVuePlugins = exports.initNVueNodeTransforms = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst easycom_1 = require(\"../plugins/easycom\");\nconst manifestJson_1 = require(\"../plugins/manifestJson\");\nconst stats_1 = require(\"../plugins/stats\");\nconst template_1 = require(\"../plugins/template\");\nconst plugin_1 = require(\"./plugin\");\nconst appCss_1 = require(\"./plugins/appCss\");\nconst esbuild_1 = require(\"./plugins/esbuild\");\nconst mainJs_1 = require(\"./plugins/mainJs\");\nconst pagesJson_1 = require(\"./plugins/pagesJson\");\nconst renderjs_1 = require(\"./plugins/renderjs\");\nvar plugin_2 = require(\"./plugin\");\nObject.defineProperty(exports, \"initNVueNodeTransforms\", { enumerable: true, get: function () { return plugin_2.initNVueNodeTransforms; } });\nfunction initNVuePlugins() {\n    const renderer = process.env.UNI_RENDERER;\n    const appService = process.env.UNI_RENDERER_NATIVE === 'appService';\n    return [\n        (0, appCss_1.uniAppCssPlugin)(),\n        (0, easycom_1.uniEasycomPlugin)({ exclude: uni_cli_shared_1.UNI_EASYCOM_EXCLUDE }),\n        (0, uni_cli_shared_1.uniHBuilderXConsolePlugin)(),\n        (0, mainJs_1.uniMainJsPlugin)({ renderer, appService }),\n        (0, manifestJson_1.uniManifestJsonPlugin)(),\n        (0, pagesJson_1.uniPagesJsonPlugin)({ renderer, appService }),\n        (0, uni_cli_shared_1.uniViteInjectPlugin)('uni:app-inject', (0, uni_cli_shared_1.initAppProvide)()),\n        (0, renderjs_1.uniRenderjsPlugin)(),\n        (0, plugin_1.uniAppNVuePlugin)({ appService }),\n        (0, esbuild_1.uniEsbuildPlugin)({ renderer, appService }),\n        ...(appService ? [(0, stats_1.uniStatsPlugin)(), (0, template_1.uniTemplatePlugin)({ renderer })] : []),\n    ];\n}\nexports.initNVuePlugins = initNVuePlugins;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniAppNVuePlugin = exports.initNVueDirectiveTransforms = exports.initNVueNodeTransforms = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst picocolors_1 = __importDefault(require(\"picocolors\"));\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst uni_nvue_styler_1 = require(\"@dcloudio/uni-nvue-styler\");\nconst utils_1 = require(\"../../utils\");\n// import { transformRenderWhole } from './transforms/transformRenderWhole'\n// import { transformAppendAsTree } from './transforms/transformAppendAsTree'\nconst transformVideo_1 = require(\"./transforms/transformVideo\");\nconst transformText_1 = require(\"./transforms/transformText\");\nconst configResolved_1 = require(\"../../plugin/configResolved\");\nconst utils_2 = require(\"../utils\");\nconst transformRootNode_1 = require(\"./transforms/transformRootNode\");\nconst vModel_1 = require(\"./transforms/vModel\");\nconst vShow_1 = require(\"./transforms/vShow\");\nconst transformAttrs_1 = require(\"./transforms/transformAttrs\");\nconst pagesJson_1 = require(\"../plugins/pagesJson\");\nconst uTags = {\n    text: 'u-text',\n    image: 'u-image',\n    input: 'u-input',\n    textarea: 'u-textarea',\n    video: 'u-video',\n    'web-view': 'u-web-view',\n    slider: 'u-slider',\n};\nfunction initNVueNodeTransforms() {\n    // 优先级必须确保 renderWhole > appendAsTree\n    return [\n        transformRootNode_1.transformRootNode,\n        (0, uni_cli_shared_1.createTransformTag)(uTags),\n        transformAttrs_1.transformAttrs,\n        transformText_1.transformText,\n        transformVideo_1.transformVideo,\n        // transformRenderWhole,\n        // transformAppendAsTree,\n    ];\n}\nexports.initNVueNodeTransforms = initNVueNodeTransforms;\nfunction initNVueDirectiveTransforms() {\n    return {\n        model: vModel_1.transformModel,\n        show: vShow_1.transformShow,\n    };\n}\nexports.initNVueDirectiveTransforms = initNVueDirectiveTransforms;\nfunction uniAppNVuePlugin({ appService, }) {\n    const inputDir = process.env.UNI_INPUT_DIR;\n    const mainPath = (0, uni_cli_shared_1.resolveMainPathOnce)(inputDir);\n    return {\n        name: 'uni:app-nvue',\n        config() {\n            return {\n                css: {\n                    postcss: {\n                        plugins: (0, uni_cli_shared_1.initPostcssPlugin)({\n                            uniApp: uni_shared_1.defaultNVueRpx2Unit,\n                            autoprefixer: false,\n                        }),\n                    },\n                },\n                build: {\n                    lib: {\n                        name: 'AppService',\n                        // 必须使用 lib 模式，否则会生成 preload 等代码\n                        fileName: appService ? 'app-service' : 'app',\n                        entry: mainPath,\n                        formats: [appService ? 'iife' : 'es'],\n                    },\n                    outDir: appService ? process.env.UNI_OUTPUT_DIR : (0, utils_1.nvueOutDir)(),\n                    rollupOptions: {\n                        external: (0, utils_2.external)(appService),\n                        output: {\n                            entryFileNames(chunk) {\n                                if (chunk.name === 'main' && chunk.isEntry) {\n                                    return appService ? uni_cli_shared_1.APP_SERVICE_FILENAME : 'app.js';\n                                }\n                                return chunk.name + '.js';\n                            },\n                            assetFileNames: '[name][extname]',\n                            chunkFileNames: createChunkFileNames(inputDir),\n                            plugins: [(0, uni_cli_shared_1.dynamicImportPolyfill)(true)],\n                            globals: (0, utils_2.globals)(appService),\n                        },\n                    },\n                },\n            };\n        },\n        configResolved: (0, configResolved_1.createConfigResolved)({\n            createCssPostPlugin(config) {\n                return {\n                    name: 'vite:css-post',\n                    buildStart() {\n                        // 用于覆盖原始插件方法\n                        // noop\n                    },\n                    async transform(source, filename) {\n                        if (!uni_cli_shared_1.cssLangRE.test(filename) || uni_cli_shared_1.commonjsProxyRE.test(filename)) {\n                            return;\n                        }\n                        const nvuePages = pagesJson_1.nvuePagesCache.get(config);\n                        if (!nvuePages || !Object.keys(nvuePages).length) {\n                            // 当前项目没有 nvue 文件\n                            return { code: `export default {}`, map: { mappings: '' } };\n                        }\n                        const { code, messages } = await (0, uni_nvue_styler_1.parse)(source, {\n                            filename,\n                            logLevel: 'WARNING',\n                        });\n                        messages.forEach((message) => {\n                            if (message.type === 'warning') {\n                                let msg = `[plugin:vite:nvue-css] ${message.text}`;\n                                if (message.line && message.column) {\n                                    msg += `\\n${(0, uni_cli_shared_1.generateCodeFrame)(source, {\n                                        line: message.line,\n                                        column: message.column,\n                                    })}`;\n                                }\n                                msg += `\\n${(0, uni_cli_shared_1.formatAtFilename)(filename)}`;\n                                config.logger.warn(picocolors_1.default.yellow(msg));\n                            }\n                        });\n                        return { code: `export default ${code}`, map: { mappings: '' } };\n                    },\n                    generateBundle() {\n                        // 用于覆盖原始插件方法\n                        // noop\n                    },\n                };\n            },\n        }),\n    };\n}\nexports.uniAppNVuePlugin = uniAppNVuePlugin;\nfunction createChunkFileNames(inputDir) {\n    return function chunkFileNames(chunk) {\n        if (chunk.isDynamicEntry && chunk.facadeModuleId) {\n            const { filename } = (0, uni_cli_shared_1.parseVueRequest)(chunk.facadeModuleId);\n            if (filename.endsWith('.nvue')) {\n                return ((0, uni_cli_shared_1.removeExt)((0, uni_cli_shared_1.normalizePath)(path_1.default.relative(inputDir, filename))) + '.js');\n            }\n        }\n        return '[name].js';\n    };\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformVideo = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst compiler_core_1 = require(\"@vue/compiler-core\");\nfunction isVideo(node) {\n    return node.tag === 'video' || node.tag === 'u-video';\n}\nconst transformVideo = (node, _) => {\n    if (!(0, uni_cli_shared_1.isElementNode)(node)) {\n        return;\n    }\n    if (!isVideo(node)) {\n        return;\n    }\n    if (!node.children.length) {\n        return;\n    }\n    const firstChild = node.children[0];\n    if ((0, uni_cli_shared_1.isElementNode)(firstChild) && firstChild.tag === 'u-scalable') {\n        return;\n    }\n    node.children = [createScalable(node)];\n};\nexports.transformVideo = transformVideo;\nfunction createScalable(node) {\n    return {\n        tag: 'u-scalable',\n        type: 1 /* ELEMENT */,\n        tagType: 0 /* ELEMENT */,\n        props: [\n            (0, uni_cli_shared_1.createBindDirectiveNode)('style', (0, compiler_core_1.createSimpleExpression)('{position:\"absolute\",left:\"0\",right:\"0\",top:\"0\",bottom:\"0\"}')),\n        ],\n        isSelfClosing: true,\n        children: node.children,\n        codegenNode: undefined,\n        ns: node.ns,\n        loc: node.loc,\n    };\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformText = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction isTextNode({ tag }) {\n    return tag === 'text' || tag === 'u-text' || tag === 'button';\n}\nfunction isText(node) {\n    const { type } = node;\n    return (type === 2 /* TEXT */ ||\n        type === 12 /* TEXT_CALL */ ||\n        type === 5 /* INTERPOLATION */ ||\n        type === 8 /* COMPOUND_EXPRESSION */);\n}\nconst transformText = (node, _) => {\n    if (!(0, uni_cli_shared_1.isElementNode)(node)) {\n        return;\n    }\n    if (isTextNode(node)) {\n        return;\n    }\n    const { children } = node;\n    if (!children.length) {\n        return;\n    }\n    children.forEach((child, index) => {\n        if (isText(child)) {\n            children.splice(index, 1, createText(node, child));\n        }\n    });\n};\nexports.transformText = transformText;\nfunction createText(parent, node) {\n    return {\n        tag: 'u-text',\n        type: 1 /* ELEMENT */,\n        tagType: 0 /* ELEMENT */,\n        props: [],\n        isSelfClosing: false,\n        children: [node],\n        codegenNode: undefined,\n        ns: parent.ns,\n        loc: node.loc,\n    };\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformRootNode = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst compiler_core_1 = require(\"@vue/compiler-core\");\nconst SCROLLER_COMPONENTS = [\n    'list',\n    'scroller',\n    'scroll-view',\n    'waterfall',\n    'recycle-list',\n];\nconst transformRootNode = (node, context) => {\n    if (node.type !== 0 /* ROOT */ || !context.bindingMetadata.__pageOptions) {\n        return;\n    }\n    const { disableScroll, scrollIndicator } = context.bindingMetadata\n        .__pageOptions;\n    // 禁用滚动，或已包含滚动元素\n    if (disableScroll || hasScrollerElement(node)) {\n        return wrapperByView(node);\n    }\n    return wrapperByScrollView(node, { scrollIndicator });\n};\nexports.transformRootNode = transformRootNode;\nfunction hasScrollerElement(node) {\n    return node.children.some((child) => {\n        if (child.type === 1 /* ELEMENT */) {\n            return SCROLLER_COMPONENTS.includes(child.tag);\n        }\n    });\n}\nfunction wrapperByScrollView(node, { scrollIndicator }) {\n    node.children = [\n        createElement('scroll-view', createScrollViewProps({ scrollIndicator }), node.children),\n    ];\n}\nconst trueExpr = (0, compiler_core_1.createSimpleExpression)('true');\nconst falseExpr = (0, compiler_core_1.createSimpleExpression)('false');\nfunction createScrollViewProps({ scrollIndicator, }) {\n    return [\n        (0, uni_cli_shared_1.createBindDirectiveNode)('scrollY', trueExpr),\n        (0, uni_cli_shared_1.createBindDirectiveNode)('showScrollbar', scrollIndicator === 'none' ? falseExpr : trueExpr),\n        (0, uni_cli_shared_1.createBindDirectiveNode)('enableBackToTop', trueExpr),\n        (0, uni_cli_shared_1.createAttributeNode)('bubble', 'true'),\n        (0, uni_cli_shared_1.createBindDirectiveNode)('style', `{flexDirection:'column'}`),\n    ];\n}\n/**\n * 目前暂不支持多节点，故发现多节点时，自动补充一个 view 根节点\n * @param node\n */\nfunction wrapperByView(node) {\n    if (node.children.length > 1) {\n        node.children = [createElement('view', [], node.children)];\n    }\n}\nfunction createElement(tag, props, children) {\n    return {\n        type: 1 /* ELEMENT */,\n        ns: 0,\n        tag,\n        isSelfClosing: false,\n        props,\n        children,\n        tagType: 0 /* ELEMENT */,\n        codegenNode: undefined,\n        loc: compiler_core_1.locStub,\n    };\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformModel = void 0;\nconst compiler_core_1 = require(\"@vue/compiler-core\");\nconst shared_1 = require(\"@vue/shared\");\nconst tags = ['u-input', 'u-textarea'];\nconst transformModel = (dir, node, context) => {\n    const result = (0, compiler_core_1.transformModel)(dir, node, context);\n    // 将 u-input,u-textarea 的 onUpdate:modelValue 事件转换为 onInput\n    if (tags.includes(node.tag) && result.props.length >= 2) {\n        const key = result.props[1].key;\n        let value = result.props[1].value;\n        if (value.type === 20 /* JS_CACHE_EXPRESSION */) {\n            value = value.value;\n        }\n        if ((0, compiler_core_1.isStaticExp)(key) &&\n            key.content === 'onUpdate:modelValue' &&\n            value.type === 8 /* COMPOUND_EXPRESSION */) {\n            key.content = 'onInput';\n            // 替换 $event 为 $event.detail.value\n            value.children = value.children.map((child) => {\n                if ((0, shared_1.isString)(child)) {\n                    return child.replace(/=\\s\\$event/g, `= $event.detail.value`);\n                }\n                return child;\n            });\n        }\n    }\n    return result;\n};\nexports.transformModel = transformModel;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformShow = void 0;\nconst errors_1 = require(\"./errors\");\nconst transformShow = (dir, node, context) => {\n    context.onError((0, errors_1.createNVueCompilerError)(0 /* X_V_SHOW */, dir.loc));\n    return {\n        props: [],\n    };\n};\nexports.transformShow = transformShow;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createNVueCompilerError = void 0;\nconst compiler_core_1 = require(\"@vue/compiler-core\");\nconst NVueErrorMessages = {\n    [0 /* X_V_SHOW */]: 'nvue: v-show is not supported',\n    [1 /* X_V_MODEL_DYNAMIC_TYPE */]: 'nvue: v-model with :type=\"\" is not supported',\n    [2 /* X_V_MODEL_AND_V_BIND */]: 'nvue: v-model with v-bind is not supported',\n};\nfunction createNVueCompilerError(code, loc, additionalMessage) {\n    return (0, compiler_core_1.createCompilerError)(code, loc, NVueErrorMessages, additionalMessage);\n}\nexports.createNVueCompilerError = createNVueCompilerError;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformAttrs = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst shared_1 = require(\"@vue/shared\");\n/**\n * 将内置组件属性调整为驼峰\n * @param node\n * @param context\n * @returns\n */\nconst transformAttrs = (node, context) => {\n    if (!(0, uni_cli_shared_1.isElementNode)(node)) {\n        return;\n    }\n    if (!(0, uni_shared_1.isAppNVueNativeTag)(node.tag)) {\n        return;\n    }\n    node.props.forEach((prop) => {\n        if ((0, uni_cli_shared_1.isDirectiveNode)(prop)) {\n            const { arg } = prop;\n            if (arg && (0, uni_cli_shared_1.isSimpleExpressionNode)(arg)) {\n                arg.content = normalizePropName(arg.content);\n            }\n        }\n        else {\n            prop.name = normalizePropName(prop.name);\n        }\n    });\n};\nexports.transformAttrs = transformAttrs;\nfunction normalizePropName(name) {\n    if (name.startsWith('data-')) {\n        return name;\n    }\n    return (0, shared_1.camelize)(name);\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniPagesJsonPlugin = exports.nvuePagesCache = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nexports.nvuePagesCache = new Map();\nfunction uniPagesJsonPlugin({ renderer, appService, }) {\n    const nvuePages = {};\n    // 仅编译nvue页面时重写\n    if (!appService) {\n        rewriteBindingMetadata(nvuePages);\n    }\n    return (0, uni_cli_shared_1.defineUniPagesJsonPlugin)((opts) => {\n        return {\n            name: 'uni:app-nvue-pages-json',\n            enforce: 'pre',\n            configResolved(config) {\n                exports.nvuePagesCache.set(config, nvuePages);\n            },\n            transform(code, id) {\n                if (!opts.filter(id)) {\n                    return;\n                }\n                this.addWatchFile(path_1.default.resolve(process.env.UNI_INPUT_DIR, 'pages.json'));\n                (0, uni_cli_shared_1.getLocaleFiles)(path_1.default.resolve(process.env.UNI_INPUT_DIR, 'locale')).forEach((filepath) => {\n                    this.addWatchFile(filepath);\n                });\n                const pagesJson = (0, uni_cli_shared_1.normalizePagesJson)(code, process.env.UNI_PLATFORM);\n                Object.keys(nvuePages).forEach((name) => {\n                    delete nvuePages[name];\n                });\n                pagesJson.pages.forEach((page) => {\n                    if (page.style.isNVue) {\n                        const filename = (0, uni_cli_shared_1.normalizePath)(path_1.default.resolve(process.env.UNI_INPUT_DIR, page.path + '.nvue'));\n                        nvuePages[filename] = {\n                            disableScroll: page.style.disableScroll,\n                            scrollIndicator: page.style.scrollIndicator,\n                        };\n                        this.addWatchFile(filename);\n                    }\n                });\n                if (renderer === 'native' && appService) {\n                    this.emitFile({\n                        fileName: uni_cli_shared_1.APP_CONFIG_SERVICE,\n                        type: 'asset',\n                        source: (0, uni_cli_shared_1.normalizeAppConfigService)(pagesJson, (0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR)),\n                    });\n                    return {\n                        code: '',\n                        map: { mappings: '' },\n                    };\n                }\n                return {\n                    code: (0, uni_cli_shared_1.normalizeAppNVuePagesJson)(pagesJson),\n                    map: { mappings: '' },\n                };\n            },\n        };\n    });\n}\nexports.uniPagesJsonPlugin = uniPagesJsonPlugin;\n/**\n * 在 BindingMetadata 中补充页面标记\n */\nfunction rewriteBindingMetadata(nvuePages) {\n    const compilerDom = require((0, uni_cli_shared_1.resolveBuiltIn)('@vue/compiler-dom'));\n    const { compile } = compilerDom;\n    compilerDom.compile = (template, options = {}) => {\n        if (options.filename && options.bindingMetadata) {\n            if (nvuePages[options.filename]) {\n                ;\n                options.bindingMetadata.__pageOptions =\n                    nvuePages[options.filename];\n            }\n        }\n        return compile(template, options);\n    };\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniMainJsPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst appCss_1 = require(\"./appCss\");\nfunction uniMainJsPlugin({ renderer, appService, }) {\n    return (0, uni_cli_shared_1.defineUniMainJsPlugin)((opts) => {\n        return {\n            name: 'uni:app-nvue-main-js',\n            enforce: 'pre',\n            transform(code, id) {\n                if (opts.filter(id)) {\n                    if (renderer !== 'native') {\n                        return {\n                            code: `import './${uni_cli_shared_1.PAGES_JSON_JS}';import('${appCss_1.APP_CSS_JS}').then(()=>{})`,\n                            map: { mappings: '' },\n                        };\n                    }\n                    if (appService) {\n                        code = code.includes('createSSRApp')\n                            ? createApp(code)\n                            : createLegacyApp(code);\n                        return {\n                            code: `import './${uni_cli_shared_1.MANIFEST_JSON_JS}';\\nimport './${uni_cli_shared_1.PAGES_JSON_JS}';\\n` +\n                                code,\n                            map: { mappings: '' },\n                        };\n                    }\n                    return {\n                        code: `import './${uni_cli_shared_1.PAGES_JSON_JS}';`,\n                        map: { mappings: '' },\n                    };\n                }\n            },\n        };\n    });\n}\nexports.uniMainJsPlugin = uniMainJsPlugin;\nfunction createApp(code) {\n    return `${code.replace('createSSRApp', 'createVueApp as createSSRApp')};const {app:__app__,Vuex:__Vuex__,Pinia:__Pinia__}=createApp();uni.Vuex=__Vuex__;uni.Pinia=__Pinia__;__app__._component.mpType='app';__app__._component.render=()=>{};__app__.mount('#app');`;\n}\nfunction createLegacyApp(code) {\n    return `function createApp(rootComponent,rootProps){rootComponent.mpTye='app';rootComponent.render=()=>{};const app=createVueApp(rootComponent,rootProps);const oldMount=app.mount;app.mount=(container)=>{const appVm=oldMount.call(app,container);return appVm;};return app;};${code.replace('createApp', 'createVueApp')}`;\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniRenderjsPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniRenderjsPlugin() {\n    return {\n        name: 'uni:app-nvue-renderjs',\n        async transform(code, id) {\n            const { type } = (0, uni_cli_shared_1.parseRenderjs)(id);\n            if (!type) {\n                return;\n            }\n            return {\n                code: `export default {}`,\n                map: { mappings: '' },\n            };\n        },\n    };\n}\nexports.uniRenderjsPlugin = uniRenderjsPlugin;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniAppPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst uni_1 = require(\"./uni\");\nconst build_1 = require(\"./build\");\nfunction uniAppPlugin({ renderer, appService, } = {\n    appService: false,\n}) {\n    return {\n        name: 'uni:app',\n        uni: (0, uni_1.uniOptions)(),\n        config(config, env) {\n            return {\n                base: '/',\n                build: (0, build_1.buildOptions)({ renderer, appService }, config, env),\n                resolve: {\n                    alias: {\n                        // vue-i18n 默认会启用 new Function 来构造翻译函数，导致在 Android 上可能报`TypeError: no access` 错误\n                        // 故：启用 runtime 模式，内部定制了简易的 compileToFunction\n                        'vue-i18n': (0, uni_cli_shared_1.resolveVueI18nRuntime)(),\n                    },\n                },\n            };\n        },\n    };\n}\nexports.uniAppPlugin = uniAppPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniOptions = void 0;\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst uni_i18n_1 = require(\"@dcloudio/uni-i18n\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst nvue_1 = require(\"../../nvue\");\nconst plugin_1 = require(\"../../nvue/plugin\");\nfunction uniOptions() {\n    const isNVueCompiler = process.env.UNI_COMPILER === 'nvue';\n    return {\n        copyOptions() {\n            const platfrom = process.env.UNI_PLATFORM;\n            const inputDir = process.env.UNI_INPUT_DIR;\n            const outputDir = process.env.UNI_OUTPUT_DIR;\n            const targets = [];\n            // 自动化测试时，不启用隐私政策\n            if (!process.env.UNI_AUTOMATOR_WS_ENDPOINT) {\n                targets.push({\n                    src: 'androidPrivacy.json',\n                    dest: outputDir,\n                    transform(source) {\n                        const options = (0, uni_cli_shared_1.initI18nOptions)(platfrom, inputDir, false, true);\n                        if (!options) {\n                            return;\n                        }\n                        return (0, uni_i18n_1.compileI18nJsonStr)(source.toString(), options);\n                    },\n                });\n                const debugFilename = '__nvue_debug__';\n                if (fs_extra_1.default.existsSync(path_1.default.resolve(inputDir, debugFilename))) {\n                    targets.push({\n                        src: debugFilename,\n                        dest: outputDir,\n                    });\n                }\n            }\n            return {\n                assets: ['hybrid/html/**/*', 'uni_modules/*/hybrid/html/**/*'],\n                targets,\n            };\n        },\n        compilerOptions: {\n            isNativeTag: isNVueCompiler ? uni_shared_1.isAppNVueNativeTag : uni_shared_1.isAppNativeTag,\n            nodeTransforms: [\n                ...(isNVueCompiler ? (0, nvue_1.initNVueNodeTransforms)() : []),\n                uni_cli_shared_1.transformTapToClick,\n                uni_cli_shared_1.transformMatchMedia,\n                uni_cli_shared_1.transformPageHead,\n            ],\n            directiveTransforms: {\n                ...(isNVueCompiler ? (0, plugin_1.initNVueDirectiveTransforms)() : {}),\n            },\n        },\n    };\n}\nexports.uniOptions = uniOptions;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildOptions = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nfunction buildOptions({ appService, renderer, }, userConfig, _) {\n    var _a;\n    const inputDir = process.env.UNI_INPUT_DIR;\n    const outputDir = process.env.UNI_OUTPUT_DIR;\n    // 开始编译时，清空输出目录\n    function emptyNVueDir() {\n        const nvueOutputDir = (0, utils_1.nvueOutDir)();\n        if (fs_1.default.existsSync(nvueOutputDir)) {\n            (0, uni_cli_shared_1.emptyDir)(nvueOutputDir);\n        }\n    }\n    function emptyOutDir() {\n        if (fs_1.default.existsSync(outputDir)) {\n            (0, uni_cli_shared_1.emptyDir)(outputDir);\n        }\n    }\n    if (renderer === 'native') {\n        if (appService) {\n            // 仅编译 main.js+App.vue 的时候才清空\n            emptyNVueDir();\n            emptyOutDir();\n        }\n    }\n    else {\n        if ((0, uni_cli_shared_1.isInHybridNVue)(userConfig)) {\n            emptyNVueDir();\n        }\n        else {\n            emptyOutDir();\n        }\n    }\n    const sourcemap = process.env.SOURCEMAP === 'true'\n        ? 'hidden'\n        : ((_a = userConfig.build) === null || _a === void 0 ? void 0 : _a.sourcemap)\n            ? 'inline'\n            : false;\n    return {\n        // App 端目前仅提供 inline\n        sourcemap,\n        emptyOutDir: false,\n        assetsInlineLimit: 0,\n        rollupOptions: {\n            input: (0, uni_cli_shared_1.resolveMainPathOnce)(inputDir),\n            output: {\n                sourcemapPathTransform(relativeSourcePath, sourcemapPath) {\n                    const sourcePath = (0, uni_cli_shared_1.normalizePath)(path_1.default.relative(inputDir, path_1.default.resolve(path_1.default.dirname(sourcemapPath), relativeSourcePath)));\n                    if (sourcePath.startsWith('..')) {\n                        return '';\n                    }\n                    return 'uni-app:///' + sourcePath;\n                },\n                manualChunks: {},\n                chunkFileNames(chunk) {\n                    if (chunk.isDynamicEntry && chunk.facadeModuleId) {\n                        const filepath = path_1.default.relative(inputDir, chunk.facadeModuleId);\n                        return (0, uni_cli_shared_1.normalizePath)(filepath.replace(path_1.default.extname(filepath), '.js'));\n                    }\n                    return '[name].js';\n                },\n                assetFileNames: '[name][extname]',\n            },\n        },\n    };\n}\nexports.buildOptions = buildOptions;\n"]}