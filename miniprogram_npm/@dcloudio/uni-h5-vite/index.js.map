{"version":3,"sources":["index.js","plugin/index.js","plugin/handleHotUpdate/index.js","plugin/transformIndexHtml/index.js","plugin/configureServer/index.js","plugin/configureServer/middlewares/timestamp.js","plugin/configureServer/ssr.js","plugin/configureServer/static.js","plugin/configureServer/middlewares/static.js","plugin/uni.js","plugin/config.js","utils/index.js","utils/ssr.js","plugin/transforms/transformPageHead.js","utils/features.js","utils/constants.js","plugin/esbuild/esbuildPrePlugin.js","plugins/css.js","plugins/easycom.js","plugins/inject.js","plugins/mainJs.js","plugins/manifestJson.js","plugins/pagesJson.js","plugins/postVue.js","plugins/renderjs.js","plugins/resolveId.js","plugins/setup.js","plugins/ssr.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AIZA,AFMA,ADGA,AENA;AHUA,AIZA,AFMA,ADGA,AENA;AHUA,AIZA,AFMA,ADGA,AENA;AHUA,AIZA,ACHA,AHSA,ADGA,AENA;AHUA,AIZA,ACHA,AHSA,ADGA,AENA;AHUA,AIZA,ACHA,AHSA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,AJYA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,AJYA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,AJYA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,ACHA,ALeA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,ACHA,ALeA,ADGA,AENA;AHUA,AIZA,ACHA,ACHA,ACHA,ALeA,ADGA;ADIA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA;ADIA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA;ADIA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA;ADIA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AIZA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AU9BA,ANkBA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AU9BA,ANkBA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AU9BA,ANkBA,AIZA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA;AT4BA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA;AXkCA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA;AXkCA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA;AXkCA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA,ACHA;AZqCA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA,ACHA;AZqCA,AU9BA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AQxBA,AENA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AENA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AENA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AENA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AKfA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AKfA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AKfA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AMlBA,ADGA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AMlBA,ADGA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,ALeA,ADGA,AYpCA,AJYA,AMlBA,ADGA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AMlBA,ADGA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AMlBA,ADGA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AKfA,AHSA,ACHA;AFOA,AFMA,AHSA,ACHA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AQxBA,AHSA,AHSA,ACHA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AQxBA,AHSA,AHSA,ACHA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,ADGA,AYpCA,AJYA,AQxBA,AHSA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,AWjCA,AJYA,AQxBA,ACHA,AJYA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,AWjCA,AIZA,ACHA,AJYA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,AWjCA,AIZA,ACHA,AJYA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,AWjCA,AIZA,ACHA,ACHA,ALeA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,AWjCA,AIZA,ACHA,ACHA,ALeA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ALeA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ANkBA,AFMA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ARwBA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ARwBA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,AT2BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,AT2BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,AT2BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,AV8BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,AV8BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,AV8BA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AXiCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AXiCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AXiCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AZoCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AZoCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AZoCA;AFOA,AFMA,AFMA,ACHA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AbuCA;AFOA,AFMA,ADGA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AbuCA;AFOA,AFMA,ADGA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,AbuCA;AFOA,AFMA,ADGA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Ad0CA;AFOA,AFMA,ADGA,AS3BA,Ad0CA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Ad0CA;AFOA,AFMA,ADGA,ALeA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Ad0CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,ANkBA,Ae7CA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AFMA,AS3BA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,ACHA,ACHA,ACHA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,ACHA,AENA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,AGTA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,AGTA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,ACHA,ACHA,AGTA,Af6CA;AFOA,AOrBA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,ACHA,AENA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AKfA,Af6CA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AGTA,ACHA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,ACHA,AIZA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA,AV8BA;AKdA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;ALgBA,AKfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst plugin_1 = require(\"./plugin\");\nconst css_1 = require(\"./plugins/css\");\nconst easycom_1 = require(\"./plugins/easycom\");\nconst inject_1 = require(\"./plugins/inject\");\nconst mainJs_1 = require(\"./plugins/mainJs\");\nconst manifestJson_1 = require(\"./plugins/manifestJson\");\nconst pagesJson_1 = require(\"./plugins/pagesJson\");\nconst postVue_1 = require(\"./plugins/postVue\");\nconst renderjs_1 = require(\"./plugins/renderjs\");\nconst resolveId_1 = require(\"./plugins/resolveId\");\nconst setup_1 = require(\"./plugins/setup\");\nconst ssr_1 = require(\"./plugins/ssr\");\nexports.default = [\n    (0, easycom_1.uniEasycomPlugin)({ exclude: uni_cli_shared_1.UNI_EASYCOM_EXCLUDE }),\n    (0, uni_cli_shared_1.uniCssScopedPlugin)({\n        filter: (id) => (0, uni_cli_shared_1.isVueSfcFile)(id) && !id.endsWith('App.vue'),\n    }),\n    (0, resolveId_1.uniResolveIdPlugin)(),\n    ...(process.env.UNI_H5_BROWSER === 'builtin'\n        ? [\n            (0, uni_cli_shared_1.uniViteInjectPlugin)('uni:h5-inject-hbx', (0, uni_cli_shared_1.initH5Provide)()),\n            (0, uni_cli_shared_1.uniHBuilderXConsolePlugin)(),\n        ]\n        : []),\n    (0, mainJs_1.uniMainJsPlugin)(),\n    (0, manifestJson_1.uniManifestJsonPlugin)(),\n    (0, pagesJson_1.uniPagesJsonPlugin)(),\n    (0, inject_1.uniInjectPlugin)(),\n    (0, css_1.uniCssPlugin)(),\n    (0, ssr_1.uniSSRPlugin)(),\n    (0, setup_1.uniSetupPlugin)(),\n    (0, renderjs_1.uniRenderjsPlugin)(),\n    (0, plugin_1.uniH5Plugin)(),\n    (0, postVue_1.uniPostVuePlugin)(),\n];\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniH5Plugin = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst handleHotUpdate_1 = require(\"./handleHotUpdate\");\nconst transformIndexHtml_1 = require(\"./transformIndexHtml\");\nconst configureServer_1 = require(\"./configureServer\");\nconst uni_1 = require(\"./uni\");\nconst config_1 = require(\"./config\");\nconst shared_1 = require(\"@vue/shared\");\nfunction uniH5Plugin() {\n    const configOptions = {\n        resolvedConfig: null,\n    };\n    rewriteReadFileSync();\n    return {\n        name: 'uni:h5',\n        uni: (0, uni_1.createUni)(),\n        config: (0, config_1.createConfig)(configOptions),\n        configResolved(config) {\n            configOptions.resolvedConfig = config;\n        },\n        configureServer: (0, configureServer_1.createConfigureServer)(),\n        handleHotUpdate: (0, handleHotUpdate_1.createHandleHotUpdate)(),\n        transformIndexHtml: (0, transformIndexHtml_1.createTransformIndexHtml)(),\n    };\n}\nexports.uniH5Plugin = uniH5Plugin;\n/**\n * 重写 readFileSync\n * 目前主要解决 scss 文件被 @import 的条件编译\n */\nfunction rewriteReadFileSync() {\n    const { readFileSync } = fs_1.default;\n    fs_1.default.readFileSync = ((filepath, options) => {\n        const content = readFileSync(filepath, options);\n        if ((0, shared_1.isString)(filepath) &&\n            (0, shared_1.isString)(content) &&\n            path_1.default.extname(filepath) === '.scss' &&\n            content.includes('#endif')) {\n            return (0, uni_cli_shared_1.preCss)(content);\n        }\n        return content;\n    });\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createHandleHotUpdate = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst shared_1 = require(\"@vue/shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst debugHmr = (0, debug_1.default)('uni:hmr');\nasync function invalidate(file, moduleGraph) {\n    const mods = await moduleGraph.getModulesByFile((0, uni_cli_shared_1.normalizePath)(file));\n    if (mods && mods.size) {\n        ;\n        [...mods].forEach((mod) => {\n            debugHmr('invalidate', mod.id);\n            moduleGraph.invalidateModule(mod);\n        });\n    }\n}\nlet invalidateFiles;\nfunction createHandleHotUpdate() {\n    return async function ({ file, server }) {\n        const inputDir = process.env.UNI_INPUT_DIR;\n        const platform = process.env.UNI_PLATFORM;\n        if (!invalidateFiles) {\n            invalidateFiles = [\n                path_1.default.resolve(inputDir, uni_cli_shared_1.PAGES_JSON_JS),\n                path_1.default.resolve(inputDir, uni_cli_shared_1.MANIFEST_JSON_JS),\n                (0, uni_cli_shared_1.resolveBuiltIn)('@dcloudio/uni-h5/dist/uni-h5.es.js'),\n            ];\n            try {\n                invalidateFiles.push((0, uni_cli_shared_1.resolveBuiltIn)('vite/dist/client/env.mjs'));\n            }\n            catch (e) { }\n        }\n        // TODO 目前简单处理，当pages.json,manifest.json发生变化，就直接刷新，理想情况下，应该区分变化的内容，仅必要时做整页面刷新\n        const isPagesJson = file.endsWith('pages.json');\n        const isManifestJson = file.endsWith('manifest.json');\n        if (!isPagesJson && !isManifestJson) {\n            return;\n        }\n        debugHmr(file);\n        const pagesJson = (0, uni_cli_shared_1.parsePagesJson)(inputDir, platform);\n        // 更新define\n        const { define, server: { middlewareMode }, } = server.config;\n        (0, shared_1.extend)(define, (0, uni_cli_shared_1.initFeatures)({\n            inputDir,\n            command: 'serve',\n            platform,\n            pagesJson,\n            manifestJson: (0, uni_cli_shared_1.parseManifestJson)(inputDir),\n            ssr: !!middlewareMode,\n        }));\n        debugHmr('define', define);\n        if (isPagesJson) {\n            const easycom = pagesJson.easycom || {};\n            const { options, refresh } = (0, uni_cli_shared_1.initEasycomsOnce)(inputDir, {\n                dirs: [(0, uni_cli_shared_1.resolveComponentsLibPath)()],\n                platform,\n            });\n            if (!equal({ autoscan: easycom.autoscan, custom: easycom.custom }, { autoscan: options.autoscan, custom: options.custom })) {\n                refresh();\n            }\n        }\n        // 当pages.json,manifest.json发生变化时，作废pages.json.js缓存\n        for (const file of invalidateFiles) {\n            await invalidate(file, server.moduleGraph);\n        }\n        server.ws.send({\n            type: 'full-reload',\n            path: '*',\n        });\n        return [];\n    };\n}\nexports.createHandleHotUpdate = createHandleHotUpdate;\nfunction equal(obj1, obj2) {\n    return JSON.stringify(obj1) === JSON.stringify(obj2);\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createTransformIndexHtml = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction createTransformIndexHtml() {\n    return async function (html) {\n        var _a;\n        const manifestJson = (0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR);\n        const title = ((_a = manifestJson.h5) === null || _a === void 0 ? void 0 : _a.title) || manifestJson.name || '';\n        return html.replace(/<title>(.*?)<\\/title>/, `<title>${title}</title>`);\n    };\n}\nexports.createTransformIndexHtml = createTransformIndexHtml;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createConfigureServer = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst timestamp_1 = require(\"./middlewares/timestamp\");\nconst ssr_1 = require(\"./ssr\");\nconst static_1 = require(\"./static\");\nfunction createConfigureServer() {\n    return function (server) {\n        (0, ssr_1.initSSR)(server);\n        const routerOptions = (0, uni_cli_shared_1.getRouterOptions)((0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR));\n        if (routerOptions.mode === 'history') {\n            server.middlewares.use((0, timestamp_1.uniTimestampMiddleware)(server));\n        }\n        return () => {\n            (0, static_1.initStatic)(server);\n        };\n    };\n}\nexports.createConfigureServer = createConfigureServer;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniTimestampMiddleware = void 0;\nconst url_1 = require(\"url\");\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nfunction uniTimestampMiddleware(server) {\n    return async function timestampMiddleware(req, _, next) {\n        // 当页面被作为组件引用时，会导致history刷新该页面直接显示js代码，因为该页面已被缓存为了module，\n        // https://github.com/vitejs/vite/blob/702d50315535c189151c67d33e4a22124f926bed/packages/vite/src/node/server/transformRequest.ts#L52\n        // /pages/tabBar/API/API\n        let { url } = req;\n        if (url) {\n            const base = server.config.base;\n            const parsed = (0, url_1.parse)(url);\n            let newUrl = url;\n            if ((parsed.pathname || '/').startsWith(base)) {\n                newUrl = newUrl.replace(base, '/');\n            }\n            if (!path_1.default.extname(newUrl) &&\n                !newUrl.endsWith('/') &&\n                !newUrl.includes('?')) {\n                const module = await server.moduleGraph.getModuleByUrl(newUrl);\n                if (module && module.file && uni_cli_shared_1.EXTNAME_VUE_RE.test(module.file)) {\n                    // /pages/tabBar/API/API => /pages/tabBar/API/API?__t__=time\n                    req.url = url + '?__t__=' + Date.now();\n                }\n            }\n        }\n        next();\n    };\n}\nexports.uniTimestampMiddleware = uniTimestampMiddleware;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initSSR = exports.external = void 0;\nexports.external = [\n    '@dcloudio/uni-app',\n    '@dcloudio/uni-app-plus',\n    '@dcloudio/uni-cloud',\n    '@dcloudio/uni-components',\n    '@dcloudio/uni-h5',\n    '@dcloudio/uni-h5-vue',\n    '@dcloudio/uni-i18n',\n    '@dcloudio/uni-mp-alipay',\n    '@dcloudio/uni-mp-baidu',\n    '@dcloudio/uni-mp-kuaishou',\n    '@dcloudio/uni-mp-lark',\n    '@dcloudio/uni-mp-qq',\n    '@dcloudio/uni-mp-toutiao',\n    '@dcloudio/uni-mp-weixin',\n    '@dcloudio/uni-quickapp-webview',\n    '@dcloudio/uni-shared',\n    '@dcloudio/uni-stat',\n    '@dcloudio/uni-stacktracey',\n    '@vue/shared',\n    'vue',\n    'vue-i18n',\n    'vue-router',\n    'vuex',\n    // dev\n    '@dcloudio/types',\n    '@dcloudio/uni-automator',\n    '@dcloudio/uni-cli-shared',\n    '@dcloudio/vite-plugin-uni',\n    'autoprefixer',\n    'typescript',\n    'vite',\n];\nfunction initSSR(server) {\n    const { ssrLoadModule } = server;\n    let added = false;\n    server.ssrLoadModule = (url) => {\n        const res = ssrLoadModule(url);\n        if (!added) {\n            // HBuilderX项目，根目录可能没有package.json，导致 ssrExternals 不生效\n            added = true;\n            if (server._ssrExternals) {\n                const { _ssrExternals } = server;\n                exports.external.forEach((module) => {\n                    if (!_ssrExternals.includes(module)) {\n                        _ssrExternals.push(module);\n                    }\n                });\n            }\n        }\n        return res;\n    };\n}\nexports.initSSR = initSSR;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createPublicFileFilter = exports.initStatic = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst pluginutils_1 = require(\"@rollup/pluginutils\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst static_1 = require(\"./middlewares/static\");\nconst debugStatic = (0, debug_1.default)('uni:static');\n/**\n * devServer时提供static等目录的静态资源服务\n * @param server\n * @param param\n */\nconst initStatic = (server) => {\n    const filter = createPublicFileFilter();\n    const serve = (0, static_1.uniStaticMiddleware)({\n        etag: true,\n        resolve(pathname) {\n            if (!filter(pathname)) {\n                return;\n            }\n            const filename = path_1.default.join(process.env.UNI_INPUT_DIR, pathname);\n            if (fs_1.default.existsSync(filename)) {\n                debugStatic(filename, 'success');\n                return filename;\n            }\n            else {\n                debugStatic(filename, 'fail');\n            }\n        },\n    });\n    const viteServePublicMiddlewareIndex = server.middlewares.stack.findIndex((middleware) => {\n        return (middleware.handle.name === 'viteServePublicMiddleware');\n    });\n    // 替换 vite 自带的 public middleware\n    if (viteServePublicMiddlewareIndex > -1) {\n        server.middlewares.stack.splice(viteServePublicMiddlewareIndex, 1, {\n            route: '',\n            handle: ((req, res, next) => {\n                if ((0, uni_cli_shared_1.isImportRequest)(req.url) || (0, uni_cli_shared_1.isInternalRequest)(req.url)) {\n                    return next();\n                }\n                return serve(req, res, next);\n            }),\n        });\n    }\n};\nexports.initStatic = initStatic;\nfunction createPublicFileFilter(base = '/') {\n    const publicDir = (0, uni_cli_shared_1.normalizePath)(path_1.default.join(base, uni_cli_shared_1.PUBLIC_DIR + '/**/*'));\n    const uniModulesDir = (0, uni_cli_shared_1.normalizePath)(path_1.default.join(base, 'uni_modules/*/' + uni_cli_shared_1.PUBLIC_DIR + '/**/*'));\n    return (0, pluginutils_1.createFilter)([publicDir, uniModulesDir]);\n}\nexports.createPublicFileFilter = createPublicFileFilter;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniStaticMiddleware = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst url_1 = __importDefault(require(\"url\"));\nconst lite_1 = __importDefault(require(\"mime/lite\"));\nfunction normalizeFile(filename, isEtag) {\n    const stats = fs_1.default.statSync(filename);\n    return {\n        stats,\n        headers: normalizeHeaders(filename, stats, isEtag),\n    };\n}\nfunction normalizeHeaders(filename, stats, isEtag) {\n    const headers = {\n        'Content-Length': stats.size,\n        'Content-Type': lite_1.default.getType(filename) || '',\n        'Last-Modified': stats.mtime.toUTCString(),\n    };\n    if (isEtag) {\n        headers['ETag'] = `W/\"${stats.size}-${stats.mtime.getTime()}\"`;\n    }\n    return headers;\n}\nfunction send(req, res, filename, stats, headers) {\n    let code = 200;\n    headers = { ...headers };\n    const opts = {};\n    for (const key in headers) {\n        const value = res.getHeader(key);\n        if (value) {\n            headers[key] = value;\n        }\n    }\n    if (res.getHeader('content-type')) {\n        headers['Content-Type'] = res.getHeader('content-type');\n    }\n    if (req.headers.range) {\n        code = 206;\n        const [x, y] = req.headers.range.replace('bytes=', '').split('-');\n        const end = (opts.end = parseInt(y, 10) || stats.size - 1);\n        const start = (opts.start = parseInt(x, 10) || 0);\n        if (start >= stats.size || end >= stats.size) {\n            res.setHeader('Content-Range', `bytes */${stats.size}`);\n            res.statusCode = 416;\n            return res.end();\n        }\n        headers['Content-Range'] = `bytes ${start}-${end}/${stats.size}`;\n        headers['Content-Length'] = end - start + 1;\n        headers['Accept-Ranges'] = 'bytes';\n    }\n    res.writeHead(code, headers);\n    fs_1.default.createReadStream(filename, opts).pipe(res);\n}\nfunction uniStaticMiddleware(opts) {\n    const isEtag = !!opts.etag;\n    return function staticMiddleware(req, res, next) {\n        const pathname = url_1.default.parse(req.url).pathname;\n        if (!pathname) {\n            return next();\n        }\n        const filename = opts.resolve(pathname);\n        if (!filename) {\n            return next();\n        }\n        const data = normalizeFile(filename, isEtag);\n        if (!data) {\n            return next();\n        }\n        if (isEtag && req.headers['if-none-match'] === data.headers['ETag']) {\n            res.writeHead(304);\n            return res.end();\n        }\n        return send(req, res, filename, data.stats, data.headers);\n    };\n}\nexports.uniStaticMiddleware = uniStaticMiddleware;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createUni = exports.compilerOptions = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nexports.compilerOptions = {\n    isNativeTag: uni_shared_1.isH5NativeTag,\n    isCustomElement: uni_shared_1.isH5CustomElement,\n    nodeTransforms: [\n        uni_cli_shared_1.transformH5BuiltInComponents,\n        uni_cli_shared_1.transformTapToClick,\n        uni_cli_shared_1.transformMatchMedia,\n        uni_cli_shared_1.transformPageHead,\n    ],\n};\nfunction createUni() {\n    return {\n        copyOptions: {\n            assets: ['hybrid/html/**/*', 'uni_modules/*/hybrid/html/**/*'],\n        },\n        compilerOptions: exports.compilerOptions,\n        jsxOptions: {\n            babelPlugins: [uni_cli_shared_1.transformUniH5Jsx],\n        },\n    };\n}\nexports.createUni = createUni;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createConfig = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nconst esbuildPrePlugin_1 = require(\"./esbuild/esbuildPrePlugin\");\nconst ssr_1 = require(\"./configureServer/ssr\");\nconst shared_1 = require(\"@vue/shared\");\nfunction createConfig(options) {\n    return function config(config, env) {\n        const inputDir = process.env.UNI_INPUT_DIR;\n        if ((0, uni_cli_shared_1.isInHBuilderX)()) {\n            if (!fs_1.default.existsSync(path_1.default.resolve(inputDir, 'index.html'))) {\n                console.error(`请确认您的项目模板是否支持vue3：根目录缺少 index.html`);\n                process.exit();\n            }\n        }\n        const server = {\n            host: true,\n            fs: { strict: false },\n            watch: {\n                ignored: ['**/uniCloud**'],\n            },\n            ...(0, uni_cli_shared_1.getDevServerOptions)((0, uni_cli_shared_1.parseManifestJsonOnce)(inputDir)),\n        };\n        if (server.port === '') {\n            delete server.port;\n        }\n        const { server: userServer } = config;\n        if (userServer) {\n            if ((0, shared_1.hasOwn)(userServer, 'host')) {\n                server.host = userServer.host;\n            }\n            if ((0, shared_1.hasOwn)(userServer, 'fs')) {\n                (0, shared_1.extend)(server.fs, userServer.fs);\n            }\n            if ((0, shared_1.hasOwn)(userServer, 'watch')) {\n                (0, shared_1.extend)(server.watch, userServer.watch);\n            }\n        }\n        return {\n            css: {\n                postcss: {\n                    plugins: (0, uni_cli_shared_1.initPostcssPlugin)({\n                        uniApp: (0, uni_cli_shared_1.parseRpx2UnitOnce)(inputDir, process.env.UNI_PLATFORM),\n                    }),\n                },\n            },\n            optimizeDeps: {\n                entries: (0, uni_cli_shared_1.resolveMainPathOnce)(inputDir),\n                exclude: ssr_1.external,\n                esbuildOptions: {\n                    plugins: [(0, esbuildPrePlugin_1.esbuildPrePlugin)()],\n                },\n            },\n            define: (0, utils_1.createDefine)(env.command, config),\n            server,\n            ssr: {\n                external: ssr_1.external,\n            },\n            build: {\n                rollupOptions: {\n                    // resolveSSRExternal 会判定package.json，hbx 工程可能没有，通过 rollup 来配置\n                    external: (0, uni_cli_shared_1.isSsr)(env.command, config) ? ssr_1.external : [],\n                    output: {\n                        chunkFileNames(chunkInfo) {\n                            const { assetsDir } = options.resolvedConfig.build;\n                            if (chunkInfo.facadeModuleId) {\n                                const dirname = path_1.default.relative(inputDir, path_1.default.dirname(chunkInfo.facadeModuleId));\n                                if (dirname) {\n                                    return path_1.default.posix.join(assetsDir, (0, uni_cli_shared_1.normalizePath)(dirname).replace(/\\//g, '-') +\n                                        '-[name].[hash].js');\n                                }\n                            }\n                            return path_1.default.posix.join(assetsDir, '[name].[hash].js');\n                        },\n                    },\n                },\n            },\n        };\n    };\n}\nexports.createConfig = createConfig;\n","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./ssr\"), exports);\n__exportStar(require(\"./features\"), exports);\n__exportStar(require(\"./constants\"), exports);\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rewriteSsrRenderStyle = exports.rewriteSsrNativeTag = exports.rewriteSsrResolve = exports.rewriteSsrVue = exports.generateSsrEntryServerCode = exports.generateSsrDefineCode = exports.initSsrDefine = exports.isSsrManifest = exports.isSSR = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\nconst shared_1 = require(\"@vue/shared\");\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst transformPageHead_1 = require(\"../plugin/transforms/transformPageHead\");\n// Temporal handling for 2.7 breaking change\nconst isSSR = (opt) => opt === undefined ? false : typeof opt === 'boolean' ? opt : (opt === null || opt === void 0 ? void 0 : opt.ssr) === true;\nexports.isSSR = isSSR;\nfunction isSsrManifest(command, config) {\n    if (command === 'build') {\n        return !!(config.build && config.build.ssrManifest);\n    }\n    return false;\n}\nexports.isSsrManifest = isSsrManifest;\nfunction initSsrDefine(config) {\n    return (0, shared_1.extend)(globalThis, {\n        __IMPORT_META_ENV_BASE_URL__: config.env.BASE_URL,\n    });\n}\nexports.initSsrDefine = initSsrDefine;\nfunction serializeDefine(define) {\n    let res = `{`;\n    for (const key in define) {\n        const val = define[key];\n        res += `${JSON.stringify(key)}: ${(0, shared_1.isString)(val) ? `(${val})` : JSON.stringify(val)}, `;\n    }\n    return res + `}`;\n}\nfunction normalizeSsrDefine(config) {\n    const defines = (0, shared_1.extend)({\n        __IMPORT_META_ENV_BASE_URL__: JSON.stringify(config.env.BASE_URL),\n    }, config.define);\n    delete defines['import.meta.env.LEGACY'];\n    return defines;\n}\nfunction generateSsrDefineCode(config, { unit, unitRatio, unitPrecision }) {\n    return fs_extra_1.default\n        .readFileSync(path_1.default.join(__dirname, '../../lib/ssr/define.js'), 'utf8')\n        .replace('__DEFINES__', serializeDefine(normalizeSsrDefine(config)))\n        .replace('__UNIT__', JSON.stringify(unit))\n        .replace('__UNIT_RATIO__', JSON.stringify(unitRatio))\n        .replace('__UNIT_PRECISION__', JSON.stringify(unitPrecision));\n}\nexports.generateSsrDefineCode = generateSsrDefineCode;\nfunction generateSsrEntryServerCode() {\n    return fs_extra_1.default.readFileSync(path_1.default.join(__dirname, '../../lib/ssr/entry-server.js'), 'utf8');\n}\nexports.generateSsrEntryServerCode = generateSsrEntryServerCode;\nfunction rewriteSsrVue() {\n    // 解决 @vue/server-renderer 中引入 vue 的映射\n    require('module-alias').addAlias('vue', (0, uni_cli_shared_1.resolveBuiltIn)('@dcloudio/uni-h5-vue/dist/vue.runtime.cjs.js'));\n    // TODO vite 2.7.0 版本会定制 require 的解析，解析后缓存的文件路径会被格式化，导致 windows 平台路径不一致，导致 cache 不生效\n    if (require('os').platform() === 'win32') {\n        require('vue');\n        const vuePath = require.resolve('vue');\n        require.cache[(0, uni_cli_shared_1.normalizePath)(vuePath)] = require.cache[vuePath];\n    }\n}\nexports.rewriteSsrVue = rewriteSsrVue;\nfunction initResolveSyncOpts(opts) {\n    if (!opts) {\n        opts = {};\n    }\n    if (!opts.paths) {\n        opts.paths = [];\n    }\n    if ((0, shared_1.isString)(opts.paths)) {\n        opts.paths = [opts.paths];\n    }\n    if ((0, shared_1.isArray)(opts.paths)) {\n        opts.paths.push(...(0, uni_cli_shared_1.getBuiltInPaths)());\n    }\n    return opts;\n}\nfunction rewriteSsrResolve() {\n    // 解决 ssr 时 __vite_ssr_import__(\"vue\") 的映射\n    const resolve = require(require.resolve('resolve', {\n        paths: [\n            path_1.default.resolve(require.resolve('vite/package.json'), '../node_modules'),\n        ],\n    }));\n    const oldSync = resolve.sync;\n    resolve.sync = (id, opts) => {\n        if (id === 'vue') {\n            return (0, uni_cli_shared_1.resolveBuiltIn)(`@dcloudio/uni-h5-vue/dist/vue.runtime.cjs.js`);\n        }\n        else if (id === 'vue/package.json') {\n            return (0, uni_cli_shared_1.resolveBuiltIn)(`@dcloudio/uni-h5-vue/package.json`);\n        }\n        else if (id === 'vue/server-renderer/package.json') {\n            return (0, uni_cli_shared_1.resolveBuiltIn)(`@vue/server-renderer/package.json`);\n        }\n        return oldSync(id, initResolveSyncOpts(opts));\n    };\n}\nexports.rewriteSsrResolve = rewriteSsrResolve;\nfunction rewriteSsrNativeTag() {\n    // @ts-ignore\n    const compilerDom = require((0, uni_cli_shared_1.resolveBuiltIn)('@vue/compiler-dom'));\n    // TODO compiler-ssr时，传入的 isNativeTag 会被 @vue/compiler-dom 的 isNativeTag 覆盖\n    // https://github.com/vuejs/vue-next/blob/master/packages/compiler-ssr/src/index.ts#L36\n    compilerDom.parserOptions.isNativeTag = uni_shared_1.isH5NativeTag;\n    // ssr 时，ssrTransformComponent 执行时机很早，导致无法正确重写 tag，故通过 resolveComponentType 解决重写\n    const oldResolveComponentType = compilerDom.resolveComponentType;\n    const newResolveComponentType = function (node, context, ssr) {\n        (0, transformPageHead_1.transformPageHead)(node, context);\n        (0, uni_cli_shared_1.transformMatchMedia)(node, context);\n        (0, uni_cli_shared_1.transformH5BuiltInComponents)(node, context);\n        return oldResolveComponentType(node, context, ssr);\n    };\n    compilerDom.resolveComponentType = newResolveComponentType;\n}\nexports.rewriteSsrNativeTag = rewriteSsrNativeTag;\nfunction rewriteSsrRenderStyle(inputDir) {\n    const { unit, unitRatio, unitPrecision } = (0, uni_cli_shared_1.parseRpx2UnitOnce)(inputDir, 'h5');\n    const rpx2unit = (0, uni_shared_1.createRpx2Unit)(unit, unitRatio, unitPrecision);\n    const shared = require('@vue/shared');\n    const oldStringifyStyle = shared.stringifyStyle;\n    shared.stringifyStyle = (styles) => rpx2unit(oldStringifyStyle(styles));\n    const serverRender = require('@vue/server-renderer');\n    const oldSsrRenderStyle = serverRender.ssrRenderStyle;\n    // 仅对字符串类型做转换，非字符串类型，通过 stringifyStyle 转换\n    serverRender.ssrRenderStyle = (raw) => (0, shared_1.isString)(raw) ? rpx2unit(oldSsrRenderStyle(raw)) : oldSsrRenderStyle(raw);\n}\nexports.rewriteSsrRenderStyle = rewriteSsrRenderStyle;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformPageHead = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst transformPageHead = (node, context) => {\n    if ((0, uni_cli_shared_1.checkElementNodeTag)(node, 'page-meta')) {\n        const headNode = node.children.find((child) => (0, uni_cli_shared_1.checkElementNodeTag)(child, 'head'));\n        if (headNode) {\n            headNode.tag = 'page-meta-head';\n        }\n        return;\n    }\n    if ((0, uni_cli_shared_1.checkElementNodeTag)(node, 'head') &&\n        (0, uni_cli_shared_1.checkElementNodeTag)(context.parent, 'page-meta')) {\n        ;\n        node.tag = 'page-meta-head';\n    }\n};\nexports.transformPageHead = transformPageHead;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createDefine = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst ssr_1 = require(\"./ssr\");\nfunction createDefine(command, config) {\n    const platform = process.env.UNI_PLATFORM;\n    const inputDir = process.env.UNI_INPUT_DIR;\n    return (0, uni_cli_shared_1.initFeatures)({\n        inputDir,\n        command,\n        platform,\n        pagesJson: (0, uni_cli_shared_1.parsePagesJsonOnce)(inputDir, platform),\n        manifestJson: (0, uni_cli_shared_1.parseManifestJsonOnce)(inputDir),\n        ssr: (0, uni_cli_shared_1.isSsr)(command, config) || (0, ssr_1.isSsrManifest)(command, config),\n    });\n}\nexports.createDefine = createDefine;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ownerModuleName = void 0;\nexports.ownerModuleName = '@dcloudio/uni-h5';\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.esbuildPrePlugin = exports.JS_TYPES_RE = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nexports.JS_TYPES_RE = /\\.(?:j|t)sx?$|\\.mjs$/;\nfunction esbuildPrePlugin() {\n    return {\n        name: 'uni:dep-scan',\n        setup(build) {\n            build.onLoad({ filter: exports.JS_TYPES_RE }, ({ path: id }) => {\n                let ext = path_1.default.extname(id).slice(1);\n                if (ext === 'mjs')\n                    ext = 'js';\n                let contents = fs_1.default.readFileSync(id, 'utf-8');\n                if (contents.includes('#endif')) {\n                    contents = (0, uni_cli_shared_1.preJs)(contents);\n                }\n                return {\n                    loader: ext,\n                    contents,\n                };\n            });\n        },\n    };\n}\nexports.esbuildPrePlugin = esbuildPrePlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assetFileNamesToFileName = exports.uniCssPlugin = void 0;\nconst fs_1 = __importDefault(require(\"fs\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst vite_1 = require(\"vite\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst shared_1 = require(\"@vue/shared\");\nfunction isCombineBuiltInCss(config) {\n    return config.command === 'build' && config.build.cssCodeSplit;\n}\nfunction uniCssPlugin() {\n    let resolvedConfig;\n    let file = '';\n    let fileName = '';\n    return {\n        name: 'uni:h5-css',\n        apply: 'build',\n        enforce: 'pre',\n        configResolved(config) {\n            resolvedConfig = config;\n            file = path_1.default.join(process.env.UNI_INPUT_DIR, 'uni.css');\n        },\n        async generateBundle() {\n            if (!isCombineBuiltInCss(resolvedConfig) || !uni_cli_shared_1.buildInCssSet.size) {\n                return;\n            }\n            // 生成框架css\n            const content = await (0, uni_cli_shared_1.minifyCSS)(generateBuiltInCssCode([...uni_cli_shared_1.buildInCssSet]), resolvedConfig);\n            const contentHash = (0, uni_cli_shared_1.getAssetHash)(Buffer.from(content, 'utf-8'));\n            const assetFileNames = path_1.default.posix.join(resolvedConfig.build.assetsDir, '[name].[hash][extname]');\n            fileName = assetFileNamesToFileName(assetFileNames, file, contentHash, content);\n            const name = (0, vite_1.normalizePath)(path_1.default.relative(resolvedConfig.root, file));\n            this.emitFile({\n                name,\n                fileName,\n                type: 'asset',\n                source: content,\n            });\n        },\n        transformIndexHtml: {\n            enforce: 'post',\n            transform() {\n                if (!fileName) {\n                    return;\n                }\n                // 追加框架css\n                return [\n                    {\n                        tag: 'link',\n                        attrs: {\n                            rel: 'stylesheet',\n                            href: toPublicPath(fileName, resolvedConfig),\n                        },\n                        injectTo: 'head-prepend',\n                    },\n                ];\n            },\n        },\n    };\n}\nexports.uniCssPlugin = uniCssPlugin;\nfunction toPublicPath(filename, config) {\n    return (0, uni_cli_shared_1.isExternalUrl)(filename) ? filename : config.base + filename;\n}\nfunction generateBuiltInCssCode(cssImports) {\n    return cssImports\n        .map((cssImport) => fs_1.default.readFileSync((0, uni_cli_shared_1.resolveBuiltIn)(cssImport), 'utf8'))\n        .join('\\n');\n}\n/**\n * converts the source filepath of the asset to the output filename based on the assetFileNames option. \\\n * this function imitates the behavior of rollup.js. \\\n * https://rollupjs.org/guide/en/#outputassetfilenames\n *\n * @example\n * ```ts\n * const content = Buffer.from('text');\n * const fileName = assetFileNamesToFileName(\n *   'assets/[name].[hash][extname]',\n *   '/path/to/file.txt',\n *   getAssetHash(content),\n *   content\n * )\n * // fileName: 'assets/file.982d9e3e.txt'\n * ```\n *\n * @param assetFileNames filename pattern. e.g. `'assets/[name].[hash][extname]'`\n * @param file filepath of the asset\n * @param contentHash hash of the asset. used for `'[hash]'` placeholder\n * @param content content of the asset. passed to `assetFileNames` if `assetFileNames` is a function\n * @returns output filename\n */\nfunction assetFileNamesToFileName(assetFileNames, file, contentHash, content) {\n    const basename = path_1.default.basename(file);\n    // placeholders for `assetFileNames`\n    // `hash` is slightly different from the rollup's one\n    const extname = path_1.default.extname(basename);\n    const ext = extname.slice(1);\n    const name = basename.slice(0, -extname.length);\n    const hash = contentHash;\n    if ((0, shared_1.isFunction)(assetFileNames)) {\n        assetFileNames = assetFileNames({\n            name: file,\n            source: content,\n            type: 'asset',\n        });\n        if (!(0, shared_1.isString)(assetFileNames)) {\n            throw new TypeError('assetFileNames must return a string');\n        }\n    }\n    else if (!(0, shared_1.isString)(assetFileNames)) {\n        throw new TypeError('assetFileNames must be a string or a function');\n    }\n    const fileName = assetFileNames.replace(/\\[\\w+\\]/g, (placeholder) => {\n        switch (placeholder) {\n            case '[ext]':\n                return ext;\n            case '[extname]':\n                return extname;\n            case '[hash]':\n                return hash;\n            case '[name]':\n                return name;\n        }\n        throw new Error(`invalid placeholder ${placeholder} in assetFileNames \"${assetFileNames}\"`);\n    });\n    return fileName;\n}\nexports.assetFileNamesToFileName = assetFileNamesToFileName;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniEasycomPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst pluginutils_1 = require(\"@rollup/pluginutils\");\nconst shared_1 = require(\"@vue/shared\");\nconst uni_shared_1 = require(\"@dcloudio/uni-shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst H5_COMPONENTS_PATH = '@dcloudio/uni-h5';\nconst baseComponents = [\n    'audio',\n    'button',\n    'canvas',\n    'checkbox',\n    'checkbox-group',\n    'editor',\n    'form',\n    'icon',\n    'image',\n    'input',\n    'label',\n    'movable-area',\n    'movable-view',\n    'navigator',\n    'picker-view',\n    'picker-view-column',\n    'progress',\n    'radio',\n    'radio-group',\n    'resize-sensor',\n    'rich-text',\n    'scroll-view',\n    'slider',\n    'swiper',\n    'swiper-item',\n    'switch',\n    'text',\n    'textarea',\n    'view',\n];\nfunction uniEasycomPlugin(options) {\n    const filter = (0, pluginutils_1.createFilter)(options.include, options.exclude);\n    let needCombineBuiltInCss = false;\n    return {\n        name: 'uni:h5-easycom',\n        configResolved(config) {\n            needCombineBuiltInCss = (0, uni_cli_shared_1.isCombineBuiltInCss)(config);\n        },\n        transform(code, id) {\n            if (!filter(id)) {\n                return;\n            }\n            const { filename, query } = (0, uni_cli_shared_1.parseVueRequest)(id);\n            if (query.type !== 'template' &&\n                (query.vue || !uni_cli_shared_1.EXTNAME_VUE_TEMPLATE.includes(path_1.default.extname(filename)))) {\n                return;\n            }\n            let i = 0;\n            const importDeclarations = [];\n            code = code.replace(/_resolveComponent\\(\"(.+?)\"(, true)?\\)/g, (str, name) => {\n                if (name && !name.startsWith('_')) {\n                    if ((0, uni_shared_1.isBuiltInComponent)(name)) {\n                        name = name.replace(uni_shared_1.COMPONENT_PREFIX, '');\n                        const local = `__syscom_${i++}`;\n                        if (needCombineBuiltInCss) {\n                            // 发行模式下，应该将内置组件css输出到入口css中\n                            resolveBuiltInCssImport(name).forEach((cssImport) => uni_cli_shared_1.buildInCssSet.add(cssImport));\n                            return (0, uni_cli_shared_1.addImportDeclaration)(importDeclarations, local, H5_COMPONENTS_PATH, (0, shared_1.capitalize)((0, shared_1.camelize)(name)));\n                        }\n                        return addBuiltInImportDeclaration(importDeclarations, local, name);\n                    }\n                    const source = (0, uni_cli_shared_1.matchEasycom)(name);\n                    if (source) {\n                        // 处理easycom组件优先级\n                        return (0, uni_cli_shared_1.genResolveEasycomCode)(importDeclarations, str, (0, uni_cli_shared_1.addImportDeclaration)(importDeclarations, `__easycom_${i++}`, source));\n                    }\n                }\n                return str;\n            });\n            if (importDeclarations.length) {\n                code = importDeclarations.join('') + code;\n            }\n            return {\n                code,\n                map: null,\n            };\n        },\n    };\n}\nexports.uniEasycomPlugin = uniEasycomPlugin;\nfunction resolveBuiltInCssImport(name) {\n    const cssImports = [];\n    if (baseComponents.includes(name)) {\n        cssImports.push(uni_cli_shared_1.BASE_COMPONENTS_STYLE_PATH + name + '.css');\n    }\n    else {\n        cssImports.push(uni_cli_shared_1.H5_COMPONENTS_STYLE_PATH + name + '.css');\n    }\n    const deps = uni_cli_shared_1.COMPONENT_DEPS_CSS[name];\n    deps && deps.forEach((dep) => cssImports.push(dep));\n    return cssImports;\n}\nfunction addBuiltInImportDeclaration(importDeclarations, local, name) {\n    resolveBuiltInCssImport(name).forEach((cssImport) => importDeclarations.push(`import '${cssImport}';`));\n    return (0, uni_cli_shared_1.addImportDeclaration)(importDeclarations, local, H5_COMPONENTS_PATH, (0, shared_1.capitalize)((0, shared_1.camelize)(name)));\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniInjectPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst shared_1 = require(\"@vue/shared\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst apiJson = require(path_1.default.resolve(__dirname, '../../lib/api.json'));\nconst uniInjectPluginOptions = {\n    exclude: [...uni_cli_shared_1.COMMON_EXCLUDE],\n    'uni.': [\n        '@dcloudio/uni-h5',\n        ((method) => apiJson.includes(method)),\n    ],\n    // 兼容 wx 对象\n    'wx.': [\n        '@dcloudio/uni-h5',\n        ((method) => apiJson.includes(method)),\n    ],\n    getApp: ['@dcloudio/uni-h5', 'getApp'],\n    getCurrentPages: ['@dcloudio/uni-h5', 'getCurrentPages'],\n    UniServiceJSBridge: ['@dcloudio/uni-h5', 'UniServiceJSBridge'],\n    UniViewJSBridge: ['@dcloudio/uni-h5', 'UniViewJSBridge'],\n};\nfunction uniInjectPlugin() {\n    let resolvedConfig;\n    const callback = function (imports, mod) {\n        const styles = mod[0] === '@dcloudio/uni-h5' &&\n            uni_cli_shared_1.API_DEPS_CSS[mod[1]];\n        if (!styles) {\n            return;\n        }\n        styles.forEach((style) => {\n            if ((0, uni_cli_shared_1.isCombineBuiltInCss)(resolvedConfig)) {\n                uni_cli_shared_1.buildInCssSet.add(style);\n            }\n            else {\n                if (!imports.has(style)) {\n                    imports.set(style, `import '${style}';`);\n                }\n            }\n        });\n    };\n    let injectPlugin;\n    return {\n        name: 'uni:h5-inject',\n        apply: 'build',\n        enforce: 'post',\n        configResolved(config) {\n            resolvedConfig = config;\n            const enableTreeShaking = (0, uni_cli_shared_1.isEnableTreeShaking)((0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR));\n            if (!enableTreeShaking) {\n                // 不启用摇树优化，移除 wx、uni 等 API 配置\n                delete uniInjectPluginOptions['wx.'];\n                delete uniInjectPluginOptions['uni.'];\n            }\n            injectPlugin = (0, uni_cli_shared_1.uniViteInjectPlugin)('uni:h5-inject', (0, shared_1.extend)(uniInjectPluginOptions, {\n                callback,\n            }));\n        },\n        transform(code, id) {\n            return injectPlugin.transform.call(this, code, id);\n        },\n    };\n}\nexports.uniInjectPlugin = uniInjectPlugin;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniMainJsPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nfunction uniMainJsPlugin() {\n    return (0, uni_cli_shared_1.defineUniMainJsPlugin)((opts) => {\n        let runSSR = false;\n        return {\n            name: 'uni:h5-main-js',\n            enforce: 'pre',\n            configResolved(config) {\n                runSSR =\n                    (0, uni_cli_shared_1.isSsr)(config.command, config) || (0, utils_1.isSsrManifest)(config.command, config);\n            },\n            transform(code, id, options) {\n                if (opts.filter(id)) {\n                    if (!runSSR) {\n                        code = code.includes('createSSRApp')\n                            ? createApp(code)\n                            : createLegacyApp(code);\n                    }\n                    else {\n                        code = (0, utils_1.isSSR)(options)\n                            ? createSSRServerApp(code)\n                            : createSSRClientApp(code);\n                    }\n                    code = `import './${uni_cli_shared_1.PAGES_JSON_JS}';${code}`;\n                    return {\n                        code,\n                        map: this.getCombinedSourcemap(),\n                    };\n                }\n            },\n        };\n    });\n}\nexports.uniMainJsPlugin = uniMainJsPlugin;\nfunction createApp(code) {\n    return `import { plugin as __plugin } from '@dcloudio/uni-h5';${code.replace('createSSRApp', 'createVueApp as createSSRApp')};createApp().app.use(__plugin).mount(\"#app\");`;\n}\nfunction createLegacyApp(code) {\n    return `import { plugin as __plugin } from '@dcloudio/uni-h5';function createApp(rootComponent,rootProps){return createVueApp(rootComponent, rootProps).use(__plugin)};${code.replace('createApp', 'createVueApp')}`;\n}\nfunction createSSRClientApp(code) {\n    return `import { plugin as __plugin } from '@dcloudio/uni-h5';import { UNI_SSR, UNI_SSR_STORE } from '@dcloudio/uni-shared';${code};const { app: __app, store: __store } = createApp();__app.use(__plugin);__store && window[UNI_SSR] && window[UNI_SSR][UNI_SSR_STORE] && __store.replaceState(window[UNI_SSR][UNI_SSR_STORE]);__app.router.isReady().then(() => __app.mount(\"#app\"));`;\n}\nfunction createSSRServerApp(code) {\n    return code;\n}\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniManifestJsonPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst defaultRouter = {\n    mode: 'hash',\n    base: '/',\n    assets: 'assets',\n};\nconst defaultAsync = {\n    loading: 'AsyncLoading',\n    error: 'AsyncError',\n    delay: 200,\n    timeout: 60000,\n    suspensible: true,\n};\nfunction uniManifestJsonPlugin() {\n    return (0, uni_cli_shared_1.defineUniManifestJsonPlugin)((opts) => {\n        let resolvedConfig;\n        return {\n            name: 'uni:h5-manifest-json',\n            enforce: 'pre',\n            configResolved(config) {\n                defaultRouter.assets = config.build.assetsDir;\n                resolvedConfig = config;\n            },\n            transform(code, id) {\n                if (!opts.filter(id)) {\n                    return;\n                }\n                const manifest = (0, uni_cli_shared_1.parseJson)(code);\n                const { debug, h5 } = manifest;\n                const router = {\n                    ...defaultRouter,\n                    ...{ base: resolvedConfig.base },\n                    ...((h5 && h5.router) || {}),\n                };\n                if (!router.base) {\n                    router.base = '/';\n                }\n                const async = { ...defaultAsync, ...((h5 && h5.async) || {}) };\n                const networkTimeout = (0, uni_cli_shared_1.normalizeNetworkTimeout)(manifest.networkTimeout);\n                const sdkConfigs = (h5 && h5.sdkConfigs) || {};\n                const qqMapKey = sdkConfigs.maps && sdkConfigs.maps.qqmap && sdkConfigs.maps.qqmap.key;\n                const googleMapKey = sdkConfigs.maps &&\n                    sdkConfigs.maps.google &&\n                    sdkConfigs.maps.google.key;\n                const aMapKey = sdkConfigs.maps && sdkConfigs.maps.amap && sdkConfigs.maps.amap.key;\n                const aMapSecurityJsCode = sdkConfigs.maps &&\n                    sdkConfigs.maps.amap &&\n                    sdkConfigs.maps.amap.securityJsCode;\n                const aMapServiceHost = sdkConfigs.maps &&\n                    sdkConfigs.maps.amap &&\n                    sdkConfigs.maps.amap.serviceHost;\n                let locale = manifest.locale;\n                locale = locale && locale.toUpperCase() !== 'AUTO' ? locale : '';\n                const i18nOptions = (0, uni_cli_shared_1.initI18nOptions)(process.env.UNI_PLATFORM, process.env.UNI_INPUT_DIR, false, false);\n                const fallbackLocale = (i18nOptions && i18nOptions.locale) || '';\n                const flexDirection = (manifest['app'] &&\n                    manifest['app'].nvue &&\n                    manifest['app'].nvue['flex-direction']) ||\n                    'column';\n                return {\n                    code: `export const appId = ${JSON.stringify(manifest.appid || '')}\n  export const appName = ${JSON.stringify(manifest.name || '')}\n  export const appVersion = ${JSON.stringify(manifest.versionName || '')}\n  export const appVersionCode = ${JSON.stringify(manifest.versionCode || '')}\n\n  export const debug = ${!!debug}\n  export const nvue = ${JSON.stringify({\n                        'flex-direction': flexDirection,\n                    })}\n  export const networkTimeout = ${JSON.stringify(networkTimeout)}\n  // h5\n  export const router = ${JSON.stringify(router)}\n  export const async = ${JSON.stringify(async)}\n  export const qqMapKey = ${JSON.stringify(qqMapKey)}\n  export const googleMapKey = ${JSON.stringify(googleMapKey)}\n  export const aMapKey = ${JSON.stringify(aMapKey)}\n  export const aMapSecurityJsCode = ${JSON.stringify(aMapSecurityJsCode)}\n  export const aMapServiceHost = ${JSON.stringify(aMapServiceHost)}\n  export const sdkConfigs = ${JSON.stringify(sdkConfigs)}\n  export const locale = '${locale}'\n  export const fallbackLocale = '${fallbackLocale}'\n  `,\n                    map: { mappings: '' },\n                };\n            },\n        };\n    });\n}\nexports.uniManifestJsonPlugin = uniManifestJsonPlugin;\n","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniPagesJsonPlugin = void 0;\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nfunction uniPagesJsonPlugin() {\n    return (0, uni_cli_shared_1.defineUniPagesJsonPlugin)((opts) => {\n        return {\n            name: 'uni:h5-pages-json',\n            enforce: 'pre',\n            transform(code, id, opt) {\n                if (opts.filter(id)) {\n                    const { resolvedConfig } = opts;\n                    const ssr = (0, utils_1.isSSR)(opt);\n                    return {\n                        code: registerGlobalCode(resolvedConfig, ssr) +\n                            generatePagesJsonCode(ssr, code, resolvedConfig),\n                        map: { mappings: '' },\n                    };\n                }\n            },\n        };\n    });\n}\nexports.uniPagesJsonPlugin = uniPagesJsonPlugin;\nfunction generatePagesJsonCode(ssr, jsonStr, config) {\n    const globalName = getGlobal(ssr);\n    const pagesJson = (0, uni_cli_shared_1.normalizePagesJson)(jsonStr, process.env.UNI_PLATFORM);\n    const { importLayoutComponentsCode, defineLayoutComponentsCode } = generateLayoutComponentsCode(globalName, pagesJson);\n    const definePagesCode = generatePagesDefineCode(pagesJson, config);\n    const uniRoutesCode = generateRoutes(globalName, pagesJson, config);\n    const uniConfigCode = generateConfig(globalName, pagesJson, config);\n    const cssCode = generateCssCode(config);\n    return `\nimport { defineAsyncComponent, resolveComponent, createVNode, withCtx, openBlock, createBlock } from 'vue'\nimport { PageComponent, AsyncLoadingComponent, AsyncErrorComponent, useI18n, setupWindow, setupPage } from '@dcloudio/uni-h5'\nimport { appId, appName, appVersion, appVersionCode, debug, networkTimeout, router, async, sdkConfigs, qqMapKey, googleMapKey, aMapKey, aMapSecurityJsCode, aMapServiceHost, nvue, locale, fallbackLocale } from './${uni_cli_shared_1.MANIFEST_JSON_JS}'\nconst locales = import.meta.globEager('./locale/*.json')\n${importLayoutComponentsCode}\nconst extend = Object.assign\n${cssCode}\n${uniConfigCode}\n${defineLayoutComponentsCode}\n${definePagesCode}\n${uniRoutesCode}\n${config.command === 'serve' ? hmrCode : ''}\nexport {}\n`;\n}\nconst hmrCode = `if(import.meta.hot){\n  import.meta.hot.on('invalidate', (data) => {\n      import.meta.hot.invalidate()\n  })\n}`;\nfunction getGlobal(ssr) {\n    return ssr ? 'global' : 'window';\n}\n// 兼容 wx 对象\nfunction registerGlobalCode(config, ssr) {\n    const name = getGlobal(ssr);\n    const enableTreeShaking = (0, uni_cli_shared_1.isEnableTreeShaking)((0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR));\n    if (enableTreeShaking && config.command === 'build' && !ssr) {\n        // 非 SSR 的发行模式，补充全局 uni 对象\n        return `import { upx2px, getApp } from '@dcloudio/uni-h5';${name}.uni = {};${name}.wx = {};${name}.rpx2px = upx2px`;\n    }\n    return `\nimport {uni,upx2px,getCurrentPages,getApp,UniServiceJSBridge,UniViewJSBridge} from '@dcloudio/uni-h5'\n${name}.getApp = getApp\n${name}.getCurrentPages = getCurrentPages\n${name}.wx = uni\n${name}.uni = uni\n${name}.UniViewJSBridge = UniViewJSBridge\n${name}.UniServiceJSBridge = UniServiceJSBridge\n${name}.rpx2px = upx2px\n${name}.__setupPage = (com)=>setupPage(com)\n`;\n}\nfunction generateCssCode(config) {\n    const define = config.define;\n    const cssFiles = [uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'base.css'];\n    if (config.isProduction) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'shadow.css');\n    }\n    // if (define.__UNI_FEATURE_PAGES__) {\n    cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'async.css');\n    // }\n    if (define.__UNI_FEATURE_RESPONSIVE__) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'layout.css');\n    }\n    if (define.__UNI_FEATURE_NAVIGATIONBAR__) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'pageHead.css');\n    }\n    if (define.__UNI_FEATURE_TABBAR__) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'tabBar.css');\n    }\n    if (define.__UNI_FEATURE_NVUE__) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'nvue.css');\n    }\n    if (define.__UNI_FEATURE_PULL_DOWN_REFRESH__) {\n        cssFiles.push(uni_cli_shared_1.H5_FRAMEWORK_STYLE_PATH + 'pageRefresh.css');\n    }\n    if (define.__UNI_FEATURE_NAVIGATIONBAR_SEARCHINPUT__) {\n        cssFiles.push(uni_cli_shared_1.BASE_COMPONENTS_STYLE_PATH + 'input.css');\n    }\n    const enableTreeShaking = (0, uni_cli_shared_1.isEnableTreeShaking)((0, uni_cli_shared_1.parseManifestJsonOnce)(process.env.UNI_INPUT_DIR));\n    if (config.command === 'serve' || !enableTreeShaking) {\n        // 开发模式或禁用摇树优化，自动添加所有API相关css\n        Object.keys(uni_cli_shared_1.API_DEPS_CSS).forEach((name) => {\n            const styles = uni_cli_shared_1.API_DEPS_CSS[name];\n            styles.forEach((style) => {\n                if (!cssFiles.includes(style)) {\n                    cssFiles.push(style);\n                }\n            });\n        });\n    }\n    return cssFiles.map((file) => `import '${file}'`).join('\\n');\n}\nfunction generateLayoutComponentsCode(globalName, pagesJson) {\n    const windowNames = {\n        topWindow: -1,\n        leftWindow: -2,\n        rightWindow: -3,\n    };\n    let importLayoutComponentsCode = '';\n    let defineLayoutComponentsCode = `${globalName}.__uniLayout = ${globalName}.__uniLayout || {}\\n`;\n    Object.keys(windowNames).forEach((name) => {\n        const windowConfig = pagesJson[name];\n        if (windowConfig && windowConfig.path) {\n            importLayoutComponentsCode += `import ${name} from './${windowConfig.path}'\\n`;\n            defineLayoutComponentsCode += `${globalName}.__uniConfig.${name}.component = setupWindow(${name},${windowNames[name]})\\n`;\n        }\n    });\n    return {\n        importLayoutComponentsCode,\n        defineLayoutComponentsCode,\n    };\n}\nfunction generatePageDefineCode(pageOptions) {\n    let pagePathWithExtname = (0, uni_cli_shared_1.normalizePagePath)(pageOptions.path, 'h5');\n    if (!pagePathWithExtname) {\n        // 不存在时，仍引用，此时编译会报错文件不存在\n        pagePathWithExtname = pageOptions.path + '.vue';\n    }\n    const pageIdent = (0, uni_cli_shared_1.normalizeIdentifier)(pageOptions.path);\n    return `const ${pageIdent}Loader = ()=>import('./${pagePathWithExtname}').then(com => setupPage(com.default || com))\nconst ${pageIdent} = defineAsyncComponent(extend({loader:${pageIdent}Loader},AsyncComponentOptions))`;\n}\nfunction generatePagesDefineCode(pagesJson, _config) {\n    const { pages } = pagesJson;\n    return (`const AsyncComponentOptions = {\n  loadingComponent: AsyncLoadingComponent,\n  errorComponent: AsyncErrorComponent,\n  delay: async.delay,\n  timeout: async.timeout,\n  suspensible: async.suspensible\n}\n` + pages.map((pageOptions) => generatePageDefineCode(pageOptions)).join('\\n'));\n}\nfunction generatePageRoute({ path, meta }, _config) {\n    const { isEntry } = meta;\n    const alias = isEntry ? `\\n  alias:'/${path}',` : '';\n    // 目前单页面未处理 query=>props\n    return `{\n  path:'/${isEntry ? '' : path}',${alias}\n  component:{setup(){ const app = getApp(); const query = app && app.$route && app.$route.query || {}; return ()=>renderPage(${(0, uni_cli_shared_1.normalizeIdentifier)(path)},query)}},\n  loader: ${(0, uni_cli_shared_1.normalizeIdentifier)(path)}Loader,\n  meta: ${JSON.stringify(meta)}\n}`;\n}\nfunction generatePagesRoute(pagesRouteOptions, config) {\n    return pagesRouteOptions.map((pageOptions) => generatePageRoute(pageOptions, config));\n}\nfunction generateRoutes(globalName, pagesJson, config) {\n    return `\nfunction renderPage(component,props){\n  return (openBlock(), createBlock(PageComponent, null, {page: withCtx(() => [createVNode(component, extend({},props,{ref: \"page\"}), null, 512 /* NEED_PATCH */)]), _: 1 /* STABLE */}))\n}\n${globalName}.__uniRoutes=[${[\n        ...generatePagesRoute((0, uni_cli_shared_1.normalizePagesRoute)(pagesJson), config),\n    ].join(',')}].map(uniRoute=>(uniRoute.meta.route = (uniRoute.alias || uniRoute.path).slice(1),uniRoute))`;\n}\nfunction generateConfig(globalName, pagesJson, config) {\n    delete pagesJson.pages;\n    delete pagesJson.subPackages;\n    delete pagesJson.subpackages;\n    pagesJson.compilerVersion = process.env.UNI_COMPILER_VERSION;\n    return `${globalName}.__uniConfig=extend(${JSON.stringify(pagesJson)},{\n  appId,\n  appName,\n  appVersion,\n  appVersionCode,\n  async,\n  debug,\n  networkTimeout,\n  sdkConfigs,\n  qqMapKey,\n  googleMapKey,\n  aMapKey,\n  aMapSecurityJsCode,\n  aMapServiceHost,\n  nvue,\n  locale,\n  fallbackLocale,\n  locales:Object.keys(locales).reduce((res,name)=>{const locale=name.replace(/\\\\.\\\\/locale\\\\/(uni-app.)?(.*).json/,'$2');extend(res[locale]||(res[locale]={}),locales[name].default);return res},{}),\n  router,\n})\n`;\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniPostVuePlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst WXS_RE = /vue&type=(wxs|renderjs)/;\nfunction uniPostVuePlugin() {\n    return {\n        name: 'uni:post-vue',\n        apply: 'serve',\n        enforce: 'post',\n        async transform(code, id) {\n            const { filename, query } = (0, uni_cli_shared_1.parseVueRequest)(id);\n            if (query.vue) {\n                return;\n            }\n            if (!uni_cli_shared_1.EXTNAME_VUE.includes(path_1.default.extname(filename))) {\n                return;\n            }\n            if (!WXS_RE.test(code)) {\n                return;\n            }\n            const hmrId = parseHmrId(code);\n            if (!hmrId) {\n                return;\n            }\n            // TODO 内部解决 @vitejs/plugin-vue 自定义块外链热刷的问题\n            // https://github.com/vitejs/vite/blob/main/packages/plugin-vue/src/main.ts#L387\n            // 没有增加 src=descriptor.id\n            // 包含外链 wxs,renderjs\n            code = code.replace(/vue&type=(wxs|renderjs)&index=([0-9]+)&src&/gi, (_, type, index) => {\n                return `vue&type=${type}&index=${index}&src=${hmrId}&`;\n            });\n            return {\n                code: code,\n                map: null,\n            };\n        },\n    };\n}\nexports.uniPostVuePlugin = uniPostVuePlugin;\nfunction parseHmrId(code) {\n    const matches = code.match(/_sfc_main.__hmrId = \"(.*)\"/);\n    return matches && matches[1];\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniRenderjsPlugin = void 0;\nconst debug_1 = __importDefault(require(\"debug\"));\nconst compiler_sfc_1 = require(\"@vue/compiler-sfc\");\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst debugRenderjs = (0, debug_1.default)('uni:h5-renderjs');\nfunction uniRenderjsPlugin() {\n    return {\n        name: 'uni:h5-renderjs',\n        transform(code, id) {\n            const { type, name } = (0, uni_cli_shared_1.parseRenderjs)(id);\n            if (!type) {\n                return;\n            }\n            debugRenderjs(id);\n            if (!name) {\n                this.error((0, uni_cli_shared_1.missingModuleName)(type, code));\n            }\n            return `${(0, compiler_sfc_1.rewriteDefault)(code.replace(/module\\.exports\\s*=/, 'export default '), '_sfc_' + type)}\n${type === 'renderjs' ? genRenderjsCode(name) : genWxsCode(name)}`;\n        },\n    };\n}\nexports.uniRenderjsPlugin = uniRenderjsPlugin;\nfunction genRenderjsCode(name) {\n    return `export default Comp => {\n  if(!Comp.$renderjs){Comp.$renderjs = []}\n  Comp.$renderjs.push('${name}')\n  if(!Comp.mixins){Comp.mixins = []}\n  Comp.mixins.push({beforeCreate(){ this['${name}'] = this },mounted(){ this.$ownerInstance = this.$gcd(this, true) }})\n  Comp.mixins.push(_sfc_renderjs)\n}`;\n}\nfunction genWxsCode(name) {\n    return `export default Comp => {\n  if(!Comp.$wxs){Comp.$wxs = []} \n  Comp.$wxs.push('${name}')\n  if(!Comp.mixins){Comp.mixins = []}\n  Comp.mixins.push({beforeCreate(){ this['${name}'] = _sfc_wxs }})\n}`;\n}\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniResolveIdPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nconst debugResolve = (0, debug_1.default)('uni:resolve');\nfunction uniResolveIdPlugin() {\n    const resolveCache = {};\n    return {\n        name: 'uni:h5-resolve-id',\n        enforce: 'pre',\n        config() {\n            resolveCache[utils_1.ownerModuleName] = (0, uni_cli_shared_1.resolveBuiltIn)(path_1.default.join(utils_1.ownerModuleName, 'dist/uni-h5.es.js'));\n            resolveCache['@dcloudio/uni-h5-vue'] = (0, uni_cli_shared_1.resolveBuiltIn)(path_1.default.join('@dcloudio/uni-h5-vue', `dist/vue.runtime.${process.env.VITEST ? 'cjs' : 'esm'}.js`));\n        },\n        resolveId(id) {\n            if (id === 'vue') {\n                id = '@dcloudio/uni-h5-vue';\n            }\n            const cache = resolveCache[id];\n            if (cache) {\n                debugResolve('cache', id, cache);\n                return cache;\n            }\n            if (id.startsWith('@dcloudio/uni-h5/style')) {\n                return (resolveCache[id] = (0, uni_cli_shared_1.resolveBuiltIn)(id));\n            }\n            if (id.startsWith('@dcloudio/uni-components/style')) {\n                return (resolveCache[id] = (0, uni_cli_shared_1.resolveBuiltIn)(id));\n            }\n        },\n    };\n}\nexports.uniResolveIdPlugin = uniResolveIdPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniSetupPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst debug_1 = __importDefault(require(\"debug\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst debugSetup = (0, debug_1.default)('uni:setup');\nfunction uniSetupPlugin() {\n    let appVuePath;\n    let resolvedConfig;\n    return {\n        name: 'uni:setup',\n        configResolved(config) {\n            resolvedConfig = config;\n            appVuePath = (0, uni_cli_shared_1.normalizePath)(path_1.default.resolve(process.env.UNI_INPUT_DIR, 'App.vue'));\n        },\n        transform(code, id) {\n            const { filename, query } = (0, uni_cli_shared_1.parseVueRequest)(id);\n            if (filename === appVuePath && !query.vue) {\n                debugSetup(filename);\n                return {\n                    code: code +\n                        `;import { setupApp } from '@dcloudio/uni-h5';setupApp(_sfc_main);`,\n                    map: (0, uni_cli_shared_1.withSourcemap)(resolvedConfig)\n                        ? this.getCombinedSourcemap()\n                        : null,\n                };\n            }\n        },\n    };\n}\nexports.uniSetupPlugin = uniSetupPlugin;\n","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniSSRPlugin = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst uni_cli_shared_1 = require(\"@dcloudio/uni-cli-shared\");\nconst utils_1 = require(\"../utils\");\nconst ENTRY_SERVER_JS = 'entry-server.js';\nfunction uniSSRPlugin() {\n    let entryServerJs;\n    let resolvedConfig;\n    const entryServerJsCode = (0, utils_1.generateSsrEntryServerCode)();\n    return {\n        name: 'uni:h5-ssr',\n        config(userConfig, env) {\n            if ((0, uni_cli_shared_1.isSsr)(env.command, userConfig)) {\n                (0, utils_1.rewriteSsrVue)();\n                (0, utils_1.rewriteSsrResolve)();\n                (0, utils_1.rewriteSsrNativeTag)();\n                (0, utils_1.rewriteSsrRenderStyle)(process.env.UNI_INPUT_DIR);\n            }\n        },\n        configResolved(config) {\n            resolvedConfig = config;\n            entryServerJs = path_1.default.join(process.env.UNI_INPUT_DIR, ENTRY_SERVER_JS);\n            if ((0, uni_cli_shared_1.isSsr)(resolvedConfig.command, resolvedConfig)) {\n                (0, utils_1.initSsrDefine)(resolvedConfig);\n            }\n        },\n        resolveId(id) {\n            if (id.endsWith(ENTRY_SERVER_JS)) {\n                return entryServerJs;\n            }\n        },\n        load(id) {\n            if (id.endsWith(ENTRY_SERVER_JS)) {\n                return entryServerJsCode;\n            }\n        },\n        generateBundle(_options, bundle) {\n            const chunk = bundle['entry-server.js'];\n            if (chunk) {\n                chunk.code =\n                    (0, utils_1.generateSsrDefineCode)(resolvedConfig, (0, uni_cli_shared_1.parseRpx2UnitOnce)(process.env.UNI_INPUT_DIR, process.env.UNI_PLATFORM)) +\n                        '\\n' +\n                        chunk.code;\n            }\n        },\n    };\n}\nexports.uniSSRPlugin = uniSSRPlugin;\n"]}